package com.herongtech.console.web.syscontroller;

import java.io.FileOutputStream;
import java.io.IOException;
import java.net.URL;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.List;

import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.lang.StringUtils;
import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

import com.herongtech.comm.socket.TcpComm;
import com.herongtech.comm.socket.TcpPackage;
import com.herongtech.commons.tools.DataUtil;
import com.herongtech.console.core.common.json.Page;
import com.herongtech.console.core.util.DateTimeUtil;
import com.herongtech.console.domain.acpt.bean.AcptBillInfo;
import com.herongtech.console.domain.acpt.dao.AcptBillInfoDao;
import com.herongtech.console.service.ServiceFactory;
import com.herongtech.console.service.interfaces.ISequenceService;
import com.herongtech.db.impl.session.DBFactory;
import com.herongtech.db.interfaces.IDB;
       
@Scope("prototype")
@Controller
@RequestMapping("/xmlController")

public class xmlController {
	private AcptBillInfoDao acptBillInfoDao=new AcptBillInfoDao();
	
	@RequestMapping(params="method=Pager")
	public ModelAndView Pager(String showCount){
		ModelAndView mv = new ModelAndView();
		mv.setViewName("system/xml/xml"); 
		Page page=new Page();
		page.setShowCount(Integer.parseInt(showCount));
		return mv;
	}


	@RequestMapping(params="method=list")
	public ModelAndView toAdd(){
		ModelAndView mv = new ModelAndView();
		mv.setViewName("system/xml/xml");
		return mv;
	}
	
	@RequestMapping(params="method=xmlList")
	public void main(String[] args,HttpServletRequest request,HttpServletResponse response) throws IOException{
		
	    String charset="UTF-8";
		URL url = null;
		String StrReq=request.getParameter("data");
		if(StrReq.equals(null)||StrReq.equals("")||StrReq.equals(" ")){
			System.out.println("报文不能为空！");
			try {
				request.getRequestDispatcher("webpage/system/xml/xml.jsp").forward(request, response);
			} catch (ServletException e) {
				e.printStackTrace();
			}
			return;
		}
		byte[] StrAnsPack=call(StrReq,charset);
		request.setAttribute("StrReq", new String(StrAnsPack,charset));
		try {
			request.getRequestDispatcher("webpage/system/xml/xml.jsp").forward(request, response);
		} catch (ServletException e) {
			e.printStackTrace();
		}
		//response.sendRedirect("webpage/system/xml/xml.jsp");
	}
	
	
	public byte[] call(String StrReq,String charset){
	    String strRemoteIP="127.0.0.1";
        int iRemotePort=7900;
        int iTimeout=50;
        byte[] StrReqPack=null;
        byte[] StrAnsPack=null;
        int anslength=0;
        TcpComm comm=null;
        int lRet=0;
        TcpPackage headPack=null;
        FileOutputStream xmlOut=null;
        
        try{
            System.out.println("-----------请求包------------");
            System.out.println(StrReq);
            
            //建立连接,发送请求
            comm = new TcpComm();
            comm.setTimeOut(iTimeout);
            lRet=comm.call(strRemoteIP, iRemotePort);
            if(lRet!=0){
                System.out.println("建立连接失败！");
                return null;
            }

            StrReqPack = new byte[6+StrReq.getBytes(charset).length];
            System.arraycopy(("X" + DataUtil.fix0BeforeString(String.valueOf(StrReq.getBytes(charset).length),5)).getBytes(charset), 0, StrReqPack, 0, 6);
            System.arraycopy(StrReq.getBytes(charset), 0, StrReqPack, 6, StrReq.getBytes(charset).length);
            lRet = comm.sendMsg(StrReqPack);
            if (lRet<0){
                System.out.println("发送信息失败！");
                return null;
            }

            //接收返回信息
            headPack = comm.recvPack(6);
            anslength = Integer.parseInt(new String(headPack.getContent(),1,5).trim());
            headPack = comm.recvPack(anslength);
            StrAnsPack = new byte[anslength];
            StrAnsPack = headPack.getContent();

            //此处需要设置返回字符集，同后台一致
            System.out.println("------------应答("+charset+")-----------");
            System.out.println(new String(StrAnsPack,charset));
           

        }catch(Exception e){
            e.printStackTrace();
        }finally{
            try {
                if (comm != null) {
                    comm.close();
                }
                if (xmlOut != null) {
                    xmlOut.close();
                }
            } catch (Exception e) {
                e.printStackTrace();
            }
        }
        return StrAnsPack;
	}
	
	
	
	@RequestMapping(params="method=gernateBill")
    public ModelAndView gernateBill(int count)throws Exception{
        ModelAndView mv = new ModelAndView();
        mv.setViewName("system/xml/xml");
        ISequenceService sequenceService=ServiceFactory.getSequenceService();
        IDB session = DBFactory.getDB();
        Connection ecdsCon=getEcdsConnection();
        String workDt=DateTimeUtil.getWorkdayString();
        for(int i=0;i<count;i++){
        String billNo="13051000010082016111"+sequenceService.getPrimaryKeyValue();
        String acptBillId=sequenceService.getPrimaryKeyValue();
        String acptBatchId=sequenceService.getPrimaryKeyValue();
        String rgctId=sequenceService.getPrimaryKeyValue();
        String curHistId=sequenceService.getPrimaryKeyValue();
        
        String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES (?, ?, '', ' ', '', '30512016130510000100820160810100003584', '2', '1', ?, '2016-08-10', '1', '测试01', '2200008660', '3', '1', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', '305100001008', ' ', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', ' ', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', 8726.00, '2016-12-26', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '150405', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', 'RC01', '63618789-4', '80197796-2', '98988907-4', 'C_02', ' ', ' ', ' ')";
//        INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES ('1600009703', '1600009702', 'A_27', ' ', ' ', ' ', '测试01', ' ', '3', '305100001008', ' ', ' ', '中国民生银行北京分行', ' ', '0', '305100001008', ' ', ' ', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', '测试01', '3', '305100001008', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '1', ' ', ' ', '出票预登记', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ');
//        INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES ('1600009726', '1600009702', 'A_01', 'A_27', ' ', ' ', '测试01', ' ', '3', '305100001008', ' ', ' ', '中国民生银行北京分行', ' ', '0', '305100001008', ' ', ' ', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', '测试01', '3', '305100001008', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-22', ' ', ' ', '1', ' ', ' ', '信息已登记通知', '1600009703', '1600009703', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ');
//        INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES ('1600009753', '1600009702', 'B_08', 'A_01', ' ', ' ', '测试01', '2200008660', '3', '305100001008', ' ', '2', '中国民生银行北京分行', ' ', '0', '305100001008', ' ', ' ', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', ' ', ' ', ' ', '测试01', '3', '305100001008', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-22', ' ', ' ', '1', ' ', ' ', '提示承兑', '1600009726', '1600009726', ' ', ' ', ' ', '1600009749', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, '63618789-4', ' ', 'RC01', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-22', ' ');
//        INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES ('1600009775', '1600009702', 'B_02', 'B_08', ' ', ' ', '测试01', '2200008660', '3', '305100001008', ' ', '2', '中国民生银行北京分行', ' ', '0', '305100001008', ' ', '2016-11-22', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', ' ', ' ', '测试01', '3', '305100001008', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-22', ' ', ' ', '1', ' ', ' ', '提示承兑回复', '1600009753', '1600009753', ' ', ' ', '1', '1600009772', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, '63618789-4', '80197796-2', 'RC01', 'RC00', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-22', ' ');
//        INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES ('1600009779', '1600009702', 'C_08', 'B_02', ' ', ' ', '测试01', '2200008660', '3', '305100001008', ' ', '2', 'YTS005', ' ', '2', '305100001008', ' ', '2016-11-22', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', ' ', ' ', '测试01', '3', '305100001008', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-22', ' ', ' ', '1', ' ', ' ', '提示收票', '1600009775', '1600009775', ' ', ' ', '1', '1600009777', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, '63618789-4', ' ', 'RC01', 'RC00', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-22', ' ');
        String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'C_02', 'C_08', ' ', ' ', '测试01', '2200008660', '3', '305100001008', ' ', '2', 'YTS005', '2200006456', '2', '305100001008', ' ', '2016-11-22', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '1', '1', '2200006456', 'YTS005', '2', '305100001008', 'YTS005', ' ', '305100001008', '2', ' ', ' ', '2016-11-22', ' ', ' ', '0', ' ', ' ', '提示收票回复', '1600009779', '1600009779', ' ', ' ', '1', '1600009783', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, '63618789-4', '98988907-4', 'RC01', 'RC01', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '1600009786', ' ', ' ', '2016-11-22', 'C_02')";
        //银票
        String acptBillSql="INSERT INTO TACPT_BILL_INFO (ACPTMX_ID, ACPT_ID, RGCT_ID, ESNO, BRANCH_NO, PROTOCAL_NO, FAC_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BRANCH_NO, REMITTER_BANK_NO, REMITTER_BANK_NAME, BILL_CLASS, BILL_TYPE, VOUCHER_TYPE, BILL_NO, BILL_MONEY, CURRENCY_CATEGORY, BILL_STATUS, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, PAYEE, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, DUE_DT, ISSUE_DT, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, COLLTN_STATUS, COLLTN_ID, SSPD_STATUS, SSPD_ID, PRINT_STATUS, PRSNTTN_ACCT_NO, PRSNTTN_NAME, PRSNTTN_BANK_NO, PRSNTTN_BANK_NAME, PAYMENT_PATH, PAYMENT_DT, CUST_REMARK, BANK_REMARK, PAY_WAIT_ORDER, TXL_CTRCT_NB, INVC_NB, REAL_ACCT_DT, REAL_ACCT_TIME, DRWG_BCK_OPER_NO, DRWG_BCK_DT, DRWG_BCK_TIME, DRWG_BCK_FLOW_NO, STATUS, APPLY_CANCEL_FLAG, REQUEST_MSG_ID, YZ_SOURCE, CONFER_NO, ACPT_DT) VALUES (?, ?, ?, 0, '0100', ' ', ' ', '测试01', '2200008660', '3', '0100', '305100001008', '中国民生银行北京分行营业部', '2', '1', '090', ?, 8726.00, 'RMB', '1', '305100001008', '中国民生银行北京分行', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '2016-12-26', '2016-08-10', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-12-26', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'BS436', ' ', '3051000010082016112200062725', ' ', ' ', '20161122')";
        String batchNo="YC010020161122003"+StringUtils.leftPad(i+"", 3,"0");
        String acptApplySql="INSERT INTO TACPT_APPLY_INFO (ACPT_ID, BATCH_NO, BRANCH_NO, PROTOCAL_NO, FAC_NO, FKJJH, PROD_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BANK_NO, REMITTER_BANK_NAME, ISSUE_BRANCH_NO, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, ISSUE_DT, DUE_DT, BILL_CLASS, BILL_TYPE, TOTAL_COUNT, TOTAL_AMT, TOTAL_AMT_FOR_DEDUCT, TOTAL_GRANT_AMT, FREEZE_TOTAL_GRANT_AMT, ACCOUNT_NO1, ACCOUNT_NAME1, ACCOUNT_BRANCH_NO1, ACCOUNT_BRANCH_NAME1, GRANT_AMT1, ACCOUNT_TYPE1, GRANT_NO1, FREEZE_GRANT_AMT1, ACCOUNT_NO2, ACCOUNT_NAME2, ACCOUNT_BRANCH_NO2, ACCOUNT_BRANCH_NAME2, GRANT_AMT2, ACCOUNT_TYPE2, GRANT_NO2, FREEZE_GRANT_AMT2, ACCOUNT_NO3, ACCOUNT_NAME3, ACCOUNT_BRANCH_NO3, ACCOUNT_BRANCH_NAME3, GRANT_AMT3, ACCOUNT_TYPE3, GRANT_NO3, FREEZE_GRANT_AMT3, ACCOUNT_NO4, ACCOUNT_NAME4, ACCOUNT_BRANCH_NO4, ACCOUNT_BRANCH_NAME4, GRANT_AMT4, ACCOUNT_TYPE4, GRANT_NO4, FREEZE_GRANT_AMT4, ACCOUNT_NO5, ACCOUNT_NAME5, ACCOUNT_BRANCH_NO5, ACCOUNT_BRANCH_NAME5, GRANT_AMT5, ACCOUNT_TYPE5, GRANT_NO5, FREEZE_GRANT_AMT5, BUSI_DIVISION, DEPT_NO, CUST_MANAGER, AUDIT_CHANNEL, LOAN_SYSTEM, BATCH_STATUS, DEDUCT_AMT, LOAN_AMT, LOAN_DT, LOAN_TIME, LOAN_START_DT, ORDER_ID, PROCESS_OPER_NO, PROCESS_DT, PROCESS_TIME, AUDIT_OPER_NO, AUDIT_DT, AUDIT_TIME, ACCT_OPER_NO, ACCOUNT_DT, ACCOUNT_TIME, ACCT_FLOW_NO, DEDUCT_OPER_NO, DEDUCT_DT, DEDUCT_TIME, OPER_NO, OPER_DT, OPER_TIME, GRANT_RATIO, LOAN_NO, PLEDGE_NO, SUSPD_BRANCH_NAME, SUSPD_BRANCH_NO, YZ_SOURCE, UPDATE_DT, UPDATE_TIME, ACCT_ORDER_ID1, ACCT_ORDER_ID2, ACCT_ORDER_ID3, ACCT_ORDER_ID4, ACCT_ORDER_ID5, REFUND_ORDER_ID, REFUND_FLAG, CONFER_NO) VALUES " +
        		"(?, ?, '0100', ' ', ' ', ' ', '030401020000000000', '测试01', '2200008660', '3', '305100001008', '中国民生银行北京分行营业部', '0100', '305100001008', '中国民生银行北京分行', '北京金融街道1号', '2016-08-10', '2016-12-26', '2', '1', 1, 8726.00, 8726.00, 0.00, 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', '1', ' ', ' ', ' ', ' ', ' ', ' ', '010001', ' ', '20161122152538', ' ', ' ', ' ', '010001', '2016-11-22', '20161122152845', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
        
        String discXML="<?xml version=\"1.0\" encoding=\"UTF-8\"?><Document><functionId>106101</functionId><exSerial>122</exSerial><bankNo>" +
        		"</bankNo><branchNo></branchNo><channel></channel><operator></operator><authOper></authOper><authPwd></authPwd>" +
        		"<applyDate>"+workDt+"</applyDate><applyTime></applyTime><reserve></reserve><reserve1></reserve1><billList><bean>" +
        		"<discType>0</discType><discRate>0.3</discRate><discMoney>1093.4</discMoney><settlementMark>0</settlementMark><inAcctNo>2</inAcctNo>" +
        		"<inBankNo>305100001008</inBankNo><applicantAcctNo>2</applicantAcctNo><discDt>"+workDt+"</discDt><signature>1</signature>" +
        		"<rgctId>"+rgctId+"</rgctId><banEndorsementMark>0</banEndorsementMark><receiverAcctNo>0</receiverAcctNo><receiverBankNo>305100001008" +
        		"</receiverBankNo><receiverName>中国民生银行北京分行营业部</receiverName><batchNo>1</batchNo><conferNo>1</conferNo><invoiceNo>1</invoiceNo>" +
        		"<remark>1</remark></bean></billList></Document>";
        
       
        session.execute(rcBillSql, rgctId,curHistId,billNo);
        session.execute(rcHistSql, curHistId,rgctId);
        session.execute(acptApplySql, acptBatchId,batchNo);
        session.execute(acptBillSql, acptBillId,acptBatchId,rgctId,billNo);
        
        String ecdsHistSQL="INSERT INTO ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) VALUES (default, 2535, '030006', '测试01', 'RC01', '63618789-4', '305100001008', '3', null, '2', null, 'YTS005', 'RC01', '98988907-4', '305100001008', '2', null, '1', null, '3051000010082016112200062728', '2016-11-22', '031', '2016-11-22', null, null, '"+billNo+"', 'SU00', '3051000010082016112200062729', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 'PS01', null, null, null, null, null, null, null)";
        Statement stment=ecdsCon.createStatement();
        stment.execute(ecdsHistSQL);
        ResultSet rs=stment.executeQuery("SELECT ID FROM ECDS_BILL_HIST where idnb='"+billNo+"'");
        if(rs.next()){
            Long ecdsHistId=rs.getLong("ID");
            stment.execute("INSERT INTO ECDS_BILL_INFO (IDNB, HIST_ID, COMRCLDRFT_TP, CMRCLDRFT_ISSEAMT, COMRCLDRFT_ISSEDT, COMRCLDRFT_DUEDT, COMRCLDRFT_BANENDRSMTMK, COMRCLDRFT_RMRK, DRWR_ROLE, DRWR_NM, DRWR_CMONID, DRWR_ELCTRNCSGNTR, DRWR_ACCTID, DRWR_ACCTACCTSVCR, DRWR_CDTRATGS, DRWR_CDTRATGAGCY, DRWR_CDTRATGDUEDT, ACCPTR_NM, ACCPTR_ACCTID, ACCPTR_ACCTSVCR, ACCPTR_AGCY_ACCTSVCR, ACCPTR_CMONID, PYEE_NM, PYEE_ACCTID, PYEE_ACCTSVCR, PYEE_CMONID, ACCPT_ROLE, PYEE_ROLE) VALUES ('"+billNo+"', "+ecdsHistId+", '1', '8726.00', '2016-08-10', '2016-12-26', 'EM00', null, 'RC01', '测试01', '63618789-4', '1', '3', '305100001008', null, null, null, '中国民生银行北京分行', '0', '305100001008', null, '80197796-2', 'YTS005', '2', '305100001008', null, 'RC00', 'RC01')");
        }
        rs.close();
        stment.close();
        call(discXML, "UTF-8");
        }
        ecdsCon.close();
        
       
        return mv;
    }
	
	//电票承兑记账岗
		@RequestMapping(params="method=elecAcceptBill")
	    public ModelAndView elecAcceptBill(int count)throws Exception{
	        ModelAndView mv = new ModelAndView();
	        mv.setViewName("system/xml/xml");
	        ISequenceService sequenceService=ServiceFactory.getSequenceService();
	        IDB session = DBFactory.getDB();
	        Connection ecdsCon=getEcdsConnection();
	        List <AcptBillInfo> acptBillInfoList= new ArrayList<AcptBillInfo>();
	        for(int i=0;i<count;i++){ 	
	        String billNo="13051000010082016112"+sequenceService.getPrimaryKeyValue();
	        String rgctId=sequenceService.getPrimaryKeyValue();
	        String curHistId=sequenceService.getPrimaryKeyValue();
	        String rcBillSql="insert into TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) values (?, ?, '3051000010082016112500063213', ' ', '1600014867', '30512016130510000100820160810100004286', '2', '1', ?, '2016-08-10', '1', '测试01', '2200008660', '3', '1', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', '305100001008', ' ', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', ' ', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', 29338.00, '2017-11-29', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '164808', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', 'RC01', '63618789-4', ' ', ' ', 'A_01', ' ', ' ', ' ')";
	        String rcHistSql="insert into TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) values (?, ?, 'A_01', 'A_27', ' ', ' ', '测试01', ' ', '3', '305100001008', ' ', ' ', '中国民生银行北京分行', ' ', '0', '305100001008', ' ', ' ', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', '测试01', '3', '305100001008', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-25', ' ', ' ', '0', ' ', ' ', '信息已登记通知', '1600014866', '1600014866', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
	        String acceptXML="<?xml version=\"1.0\" encoding=\"UTF-8\"?><Document><functionId>102101</functionId><exSerial>122</exSerial><bankNo></bankNo><branchNo></branchNo><channel></channel><operator></operator><authOper></authOper><authPwd></authPwd><applyDate></applyDate><applyTime></applyTime><reserve>" +
	        		          "</reserve><reserve1></reserve1><custAccount>3</custAccount><rgctIds>"+rgctId+"</rgctIds><signature>2</signature></Document>";
	        //银票  
	        session.execute(rcBillSql, rgctId,curHistId,billNo);
	        session.execute(rcHistSql, curHistId,rgctId);
	        String ecdsHistSQL="insert into ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) values (default, null, '010004', '测试01', 'RC01', '63618789-4', '305100001008', '3', null, '1', null, '测试01', 'RC01', '63618789-4', '305100001008', '3', null, null, null, '3051000010082016112500063213', '2016-11-25', '001', null, null, null, '"+billNo+"', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)"; 
	        Statement stment=ecdsCon.createStatement();
	        stment.execute(ecdsHistSQL);
	        ResultSet rs=stment.executeQuery("SELECT ID FROM ECDS_BILL_HIST where idnb='"+billNo+"'");
	        if(rs.next()){
	            Long ecdsHistId=rs.getLong("ID");
	            stment.execute("insert into ECDS_BILL_INFO (IDNB, HIST_ID, COMRCLDRFT_TP, CMRCLDRFT_ISSEAMT, COMRCLDRFT_ISSEDT, COMRCLDRFT_DUEDT, COMRCLDRFT_BANENDRSMTMK, COMRCLDRFT_RMRK, DRWR_ROLE, DRWR_NM, DRWR_CMONID, DRWR_ELCTRNCSGNTR, DRWR_ACCTID, DRWR_ACCTACCTSVCR, DRWR_CDTRATGS, DRWR_CDTRATGAGCY, DRWR_CDTRATGDUEDT, ACCPTR_NM, ACCPTR_ACCTID, ACCPTR_ACCTSVCR, ACCPTR_AGCY_ACCTSVCR, ACCPTR_CMONID, PYEE_NM, PYEE_ACCTID, PYEE_ACCTSVCR, PYEE_CMONID, ACCPT_ROLE, PYEE_ROLE) values ('"+billNo+"', "+ecdsHistId+", '1', '29338.00', '2016-08-10', '2017-11-29', 'EM00', null, 'RC01', '测试01', '63618789-4', '1', '3', '305100001008', null, null, null, '中国民生银行北京分行', '0', '305100001008', null, null, 'YTS005', '2', '305100001008', null, null, null)");
	        }
	        rs.close();
	        stment.close();
	        call(acceptXML, "UTF-8"); 
	        } 
	        ecdsCon.close();
	        return mv;
	    }
		
	
	
	//纸票承兑记账岗
	@RequestMapping(params="method=entityAcceptBill")
    public ModelAndView entityAcceptBill(int count)throws Exception{
        ModelAndView mv = new ModelAndView();
        mv.setViewName("system/xml/xml");
        ISequenceService sequenceService=ServiceFactory.getSequenceService();
        IDB session = DBFactory.getDB();
        String acptId=sequenceService.getPrimaryKeyValue();
        String batchNo="CD0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
        String protocalNo="gh"+(StringUtils.leftPad(System.currentTimeMillis()+"",14,"0")).substring(11);
        String acptApplySql="insert into TACPT_APPLY_INFO (ACPT_ID, BATCH_NO, BRANCH_NO, PROTOCAL_NO, FAC_NO, FKJJH, PROD_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BANK_NO, REMITTER_BANK_NAME, ISSUE_BRANCH_NO, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, ISSUE_DT, DUE_DT, BILL_CLASS, BILL_TYPE, TOTAL_COUNT, TOTAL_AMT, TOTAL_AMT_FOR_DEDUCT, TOTAL_GRANT_AMT, FREEZE_TOTAL_GRANT_AMT, ACCOUNT_NO1, ACCOUNT_NAME1, ACCOUNT_BRANCH_NO1, ACCOUNT_BRANCH_NAME1, GRANT_AMT1, ACCOUNT_TYPE1, GRANT_NO1, FREEZE_GRANT_AMT1, ACCOUNT_NO2, ACCOUNT_NAME2, ACCOUNT_BRANCH_NO2, ACCOUNT_BRANCH_NAME2, GRANT_AMT2, ACCOUNT_TYPE2, GRANT_NO2, FREEZE_GRANT_AMT2, ACCOUNT_NO3, ACCOUNT_NAME3, ACCOUNT_BRANCH_NO3, ACCOUNT_BRANCH_NAME3, GRANT_AMT3, ACCOUNT_TYPE3, GRANT_NO3, FREEZE_GRANT_AMT3, ACCOUNT_NO4, ACCOUNT_NAME4, ACCOUNT_BRANCH_NO4, ACCOUNT_BRANCH_NAME4, GRANT_AMT4, ACCOUNT_TYPE4, GRANT_NO4, FREEZE_GRANT_AMT4, ACCOUNT_NO5, ACCOUNT_NAME5, ACCOUNT_BRANCH_NO5, ACCOUNT_BRANCH_NAME5, GRANT_AMT5, ACCOUNT_TYPE5, GRANT_NO5, FREEZE_GRANT_AMT5, BUSI_DIVISION, DEPT_NO, CUST_MANAGER, AUDIT_CHANNEL, LOAN_SYSTEM, BATCH_STATUS, DEDUCT_AMT, LOAN_AMT, LOAN_DT, LOAN_TIME, LOAN_START_DT, ORDER_ID, PROCESS_OPER_NO, PROCESS_DT, PROCESS_TIME, AUDIT_OPER_NO, AUDIT_DT, AUDIT_TIME, ACCT_OPER_NO, ACCOUNT_DT, ACCOUNT_TIME, ACCT_FLOW_NO, DEDUCT_OPER_NO, DEDUCT_DT, DEDUCT_TIME, OPER_NO, OPER_DT, OPER_TIME, GRANT_RATIO, LOAN_NO, PLEDGE_NO, SUSPD_BRANCH_NAME, SUSPD_BRANCH_NO, YZ_SOURCE, UPDATE_DT, UPDATE_TIME, ACCT_ORDER_ID1, ACCT_ORDER_ID2, ACCT_ORDER_ID3, ACCT_ORDER_ID4, ACCT_ORDER_ID5, REFUND_ORDER_ID, REFUND_FLAG, CONFER_NO) values"+
        		"(?, ?, '0100', ?, ' ', ' ', '030401020000000000', '测试01', '2200008660', '3', '305100001008', '中国民生银行北京分行营业部', ' ', ' ', '中国民生银行北京分行', ' ', '2016-08-10', '2017-11-29', '1', '1', 1, 48304.00, 48304.00, 0.00, 0.00, '2', 'YTS005', '0101', '中国民生银行北京分行营业部', 0.00, '0', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', '1', '1', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2017-11-29', '20161129194757', ' ', ' ', ' ', '010001', '2017-11-29', '20161129194808', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
		for(int i=0;i<count;i++){
		String billNo="1234565"+sequenceService.getPrimaryKeyValue();
		String rgctId=sequenceService.getPrimaryKeyValue();
        String acptmxId=sequenceService.getPrimaryKeyValue();
        //银票
        String acptBillSql="insert into tacpt_bill_info(acptmx_id,acpt_id,rgct_id,esno,branch_no,protocal_no,fac_no,remitter,remitter_cust_no,remitter_acct,remitter_branch_no,remitter_bank_no,remitter_bank_name,bill_class,bill_type,voucher_type,bill_no,bill_money,currency_category,bill_status,drawee_bank_no,drawee_bank_name,drawee_addr,payee,payee_acct,payee_bank_no,payee_bank_name,issue_dt,due_dt,acpt_dt,acceptor,acceptor_acct,acceptor_bank_no,acceptor_bank_name,colltn_status,colltn_id,sspd_status,sspd_id,print_status,prsnttn_acct_no,prsnttn_name,prsnttn_bank_no,prsnttn_bank_name,payment_path,payment_dt,cust_remark,bank_remark,pay_wait_order,txl_ctrct_nb,invc_nb,real_acct_dt,real_acct_time,drwg_bck_oper_no,drwg_bck_dt,drwg_bck_time,drwg_bck_flow_no,status,apply_cancel_flag,request_msg_id,yz_source,confer_no)values"+
        		"(?,?,?,'0','0100',?,' ','测试01','2200008660','3','0100','305100001008','中国民生银行北京分行营业部','1','1','090',?,'11111','RMB','0','305100001008','中国民生银行北京分行','北京金融街道1号','YTS005','2','305100001008','中国民生银行北京分行营业部','2016-08-10','2017-11-29','20161129','中国民生银行北京分行','0','305100001008','中国民生银行北京分行','0',' ','0',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ',' ','BS420',' ','3051000010082016111400061943','0',' ')";

        session.execute(acptBillSql, acptmxId,acptId,rgctId,protocalNo,billNo);
        }
		session.execute(acptApplySql,acptId,batchNo,protocalNo);
        return mv;
    }
	
	
	
	
	
	
	
	
	//纸票托收申请查询,纸票转卖申请查询
	@RequestMapping(params="method=entityCollectionBill")
    public ModelAndView entitycollectionBill(int count)throws Exception{
        ModelAndView mv = new ModelAndView();
        mv.setViewName("system/xml/xml");
        ISequenceService sequenceService=ServiceFactory.getSequenceService();
        IDB session = DBFactory.getDB();
		for(int i=0;i<count;i++){
        String billNo="9994565"+sequenceService.getPrimaryKeyValue();
        String rgctId=sequenceService.getPrimaryKeyValue();
        String curHistId=sequenceService.getPrimaryKeyValue();
        String balanceId=sequenceService.getPrimaryKeyValue();
        String discMXId=sequenceService.getPrimaryKeyValue();

        String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES " +
                 "(?, ?, ' ', ' ', ' ', '3051201611231992075500166666', '1', '1', ?, '2016-11-23', '1', 'xyjy', ' ', '1', ' ', ' ', '中国民生银行北京分行', '中国民生银行北京分行', '305100001008', ' ', '北京金融街道1号', 'xyjy', '2', ' ', '中国光大银行', '中国民生银行北京分行', ' ', ' ', ' ', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', 9999999.00, '2016-12-01', ' ', ' ', ' ', ' ', ' ', '222', ' ', ' ', ' ', '2016-11-23', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', ' ', ' ', ' ', ' ', 'F_02', '0100', '0100', ' ')";     
        String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES " +
                 "(?, ?, 'F_02', 'F_11', 'F_98', ' ', ' ', '2200006456', '2', ' ', ' ', ' ', '中国民生银行北京分行', ' ', '0', '305100001008', '0100', '2016-11-23', ' ', 0.003000, 4833.33, 9995165.67, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', '中国民生银行北京分行', '0', '305100001008', ' ', ' ', ' ', '2', ' ', ' ', '2016-11-23', ' ', ' ', '0', ' ', ' ', '贴现签收', '1600010118', '1600010118', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.003000, '2016-11-23', '3', ' ', '1', '1', '2016-12-01', 58, 0.00, ' ', ' ', ' ', ' ', 'YTS005', ' ', '0100', '0100', '1', ' ', ' ', '中国民生银行北京分行', '1600010122', ' ', ' ', ' ', 'F_02')"; 
        //银票
        String acctbalanceSql="insert into TACCT_BALANCE (BALANCE_ID, INFO_ID, RGCT_ID, BILL_NO, START_DT, END_DT, CUST_NO, CUST_NAME, PROD_NO, STATUS, CREATE_DT, CREATE_TM, UPDATE_DT, UPDATE_TM, STORAGE_BRCH_NO, STORAGE_BRCH_NAME, ACCT_BRCH_NO, ACCT_BRCH_NAME) values"+ 
        		      "(?, ?, ?, ?, '2016-11-23', ' ', '2200006456', 'YTS005', '001001003', '1', '161123', '09:45:53', ' ', ' ', ' ', ' ', ' ', ' ')";
        String discBillSql="insert into TDISC_BILL_INFO (DISCMX_ID, BILL_TYPE, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_BRANCH_NO, BILL_MONEY, DRAWEE_ADDR, PAYEE_BANK_NO, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, DISC_ID, RGCT_ID, CUST_NO, CUST_ACCOUNT, SALER_INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, BUYER_INTEREST, PAY_MONEY, IS_SAME_CITY, REMARK, IS_AUDITED, CONFER_NO, IS_ACCPT, LIMIT_PROD_NO, RATE, RATE_TYPE, DISC_DT, DISC_TYPE, FILE_NO, NO_LOU_LOANS, IS_ONLINE, REDEEM_END_DATE, PROFESSION_ID, BANK_PROD_NO, LOCAL_PAY_MONEY, IS_AMOUNT, FORBID_FLAG, IS_THIRD_AMOUNT, OUT_APPLY_NO, BRANCH_NO, OPER_BANK_NO, YZ_SOURCE, PRODUCT_ID, OWNER_PARTY_ID, IS_CYC, IS_CANCEL, REDEEM_OPEN_DT, DISC_SQUARE_ID, IN_ACCT_NO, IN_BANK_NO, EX_SERIAL, UPDATE_DT, UPDATE_TIME, ACCOUNT_DATE, ACCOUNT_TIME, COLL_DT, BILL_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, GATH_MNEY_TYPE, GATH_MNEY_DATE, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, AUDIT_COMMIT_DATE, AUDIT_COMMIT_TIME, ACCT_COMMIT_DATE, ACCT_COMMIT_TIME, TOTAL_INTRST_PAYMENT, DELAY_TYPE, ORG_CODE, QUERY_RESULT, QUERY_CONTENT, RETURN_CONTENT, REQ_MSG_ID, IN_STORE_DT, IN_STORE_TIME, INVOICE_NO, DRAFT_PAY_MONEY, COLL_ACCOUNT_DT, PROTOCAL_NO, CHANGE_DT, CHANGE_TIME, LAST_BILL_NO, CUR_STATUS, TRANS_ID, BUYBACK_ID, TRANS_TYPE, IS_REDEEM, LIMIT_REDUCE_ROW, OWNER_PARTY_NAME, AUDIT_REASON) values"+ 
        		"(?, '1', '2016-11-23', '2016-12-01', 'xyjy', '1', '中国民生银行北京分行', '305100001008', '中国民生银行北京分行', ' ', ' ', '中国民生银行北京分行', ' ', 9999999.00, '北京金融街道1号', ' ', 'xyjy', '中国光大银行', '2', ' ', ' ', '1', '2', 'BS041', '1600010112', ?, '2200006456', '2', 4833.33, 3, '2016-12-01', 58, 0.00, 9995165.67, '1', '222', ' ', ' ', '1', ' BS012', 0.300000, '360', '2016-11-23', '0', ' ', ' ', ' ', ' ', null, ' ', 9995165.67, ' ', ' ', ' ', ' ', '0100', ' ', '0', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-23', '2016-11-23 09:45:52', ' ', ?, ' ', '010001', ' ', '1', ' ', '2016-11-23', '2016-11-23 09:46:03', '2016-11-23', '2016-11-23 09:45:45', ' ', ' ', 0.00, '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', '2341234', ' ', ' ', '00166666', '1', ' ', ' ', '1', ' ', ' ', ' ', ' ')"; 
        session.execute(rcBillSql, rgctId,curHistId,billNo);
        session.execute(rcHistSql, curHistId,rgctId);
        session.execute(acctbalanceSql, balanceId,discMXId,rgctId,billNo);
        session.execute(discBillSql,discMXId,rgctId,billNo);
		} 
        return mv;
    }
	
	
	
	    //电票托收查询岗
		@RequestMapping(params="method=elecCollectionBill")
	    public ModelAndView elecCollectionBill(int count)throws Exception{
	        ModelAndView mv = new ModelAndView();
	        mv.setViewName("system/xml/xml");
	        ISequenceService sequenceService=ServiceFactory.getSequenceService();
	        IDB session = DBFactory.getDB();
	        Connection ecdsCon=getEcdsConnection();
	        
	        for(int i=0;i<count;i++){
	        String billNo="13051000010082016112"+sequenceService.getPrimaryKeyValue();
	        String rgctId=sequenceService.getPrimaryKeyValue();
	        String curHistId=sequenceService.getPrimaryKeyValue();
	        String balanceId=sequenceService.getPrimaryKeyValue();
	        String discMXId=sequenceService.getPrimaryKeyValue();
	        
	        String acptMxId=sequenceService.getPrimaryKeyValue();
	        String acptId=sequenceService.getPrimaryKeyValue();
	        String batchNo="CD0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
	        
	        
	        
	        
	        String rcBillSql="insert into TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) values (?, ?, '3051000010082016112500063159', ' ', '1600014237', '30512016130510000100820160810100004235', '2', '1', ?, '2016-08-10', '1', '测试01', '2200008660', '3', '1', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', '305100001008', ' ', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', ' ', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', '1', 25978.00, '2017-11-29', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '113003', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', 'RC01', '63618789-4', '80197796-2', '98988907-4', 'F_02', ' ', ' ', ' ')";
	        String rcHistSql="insert into TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) values (?, ?, 'F_02', 'F_08', ' ', 'TX010020161125003879', 'YTS005', '2200006456', '2', '305100001008', ' ', '1', '中国民生银行北京分行营业部', '2200006456', '0', '305100001008', ' ', '2016-11-25', ' ', 0.300000, 0.00, 25869.80, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', '1', '2200006456', '中国民生银行北京分行营业部', '0', '305100001008', '中国民生银行北京分行营业部', ' ', '305100001008', '0', ' ', ' ', '2016-11-25', ' ', ' ', '0', ' ', ' ', '买断式贴现回复', '1600014231', '1600014231', '0', ' ', '1', '1600014238', ' ', ' ', ' ', ' ', ' ', ' ', '2', '305100001008', ' ', ' ', '0', ' ', ' ', ' ', 0.300000, '2016-11-25', '3', ' ', '1', ' ', '2017-11-29', 5, 0.00, '98988907-4', '80197796-2', 'RC01', 'RC00', 'YTS005', ' ', ' ', ' ', '1', ' ', ' ', ' ', '1600014241', ' ', ' ', '2016-11-25', 'F_02')";
	        //银票        
	        String acptBillSql="insert into TACPT_BILL_INFO(ACPTMX_ID, ACPT_ID, RGCT_ID, ESNO, BRANCH_NO, PROTOCAL_NO, FAC_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BRANCH_NO, REMITTER_BANK_NO, REMITTER_BANK_NAME, BILL_CLASS, BILL_TYPE, VOUCHER_TYPE, BILL_NO, BILL_MONEY, CURRENCY_CATEGORY, BILL_STATUS, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, PAYEE, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, DUE_DT, ISSUE_DT, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, COLLTN_STATUS, COLLTN_ID, SSPD_STATUS, SSPD_ID, PRINT_STATUS, PRSNTTN_ACCT_NO, PRSNTTN_NAME, PRSNTTN_BANK_NO, PRSNTTN_BANK_NAME, PAYMENT_PATH, PAYMENT_DT, CUST_REMARK, BANK_REMARK, PAY_WAIT_ORDER, TXL_CTRCT_NB, INVC_NB, REAL_ACCT_DT, REAL_ACCT_TIME, DRWG_BCK_OPER_NO, DRWG_BCK_DT, DRWG_BCK_TIME, DRWG_BCK_FLOW_NO, STATUS, APPLY_CANCEL_FLAG, REQUEST_MSG_ID, YZ_SOURCE, CONFER_NO, ACPT_DT) values " +
	                "(?, ?, ?, 0, '0100', ' ', ' ', '测试01', '2200008660', '3', '0100', '305100001008', '中国民生银行北京分行营业部', '2', '1', '090', ?, 25978.00, 'RMB', '1', '305100001008', '中国民生银行北京分行', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '2017-11-29', '2016-08-10', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2017-11-29', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'BS436', ' ', '3051000010082016112500063140', '0', ' ', '20161125')";

	        String acptApplySql="insert into TACPT_APPLY_INFO (ACPT_ID, BATCH_NO, BRANCH_NO, PROTOCAL_NO, FAC_NO, FKJJH, PROD_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BANK_NO, REMITTER_BANK_NAME, ISSUE_BRANCH_NO, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, ISSUE_DT, DUE_DT, BILL_CLASS, BILL_TYPE, TOTAL_COUNT, TOTAL_AMT, TOTAL_AMT_FOR_DEDUCT, TOTAL_GRANT_AMT, FREEZE_TOTAL_GRANT_AMT, ACCOUNT_NO1, ACCOUNT_NAME1, ACCOUNT_BRANCH_NO1, ACCOUNT_BRANCH_NAME1, GRANT_AMT1, ACCOUNT_TYPE1, GRANT_NO1, FREEZE_GRANT_AMT1, ACCOUNT_NO2, ACCOUNT_NAME2, ACCOUNT_BRANCH_NO2, ACCOUNT_BRANCH_NAME2, GRANT_AMT2, ACCOUNT_TYPE2, GRANT_NO2, FREEZE_GRANT_AMT2, ACCOUNT_NO3, ACCOUNT_NAME3, ACCOUNT_BRANCH_NO3, ACCOUNT_BRANCH_NAME3, GRANT_AMT3, ACCOUNT_TYPE3, GRANT_NO3, FREEZE_GRANT_AMT3, ACCOUNT_NO4, ACCOUNT_NAME4, ACCOUNT_BRANCH_NO4, ACCOUNT_BRANCH_NAME4, GRANT_AMT4, ACCOUNT_TYPE4, GRANT_NO4, FREEZE_GRANT_AMT4, ACCOUNT_NO5, ACCOUNT_NAME5, ACCOUNT_BRANCH_NO5, ACCOUNT_BRANCH_NAME5, GRANT_AMT5, ACCOUNT_TYPE5, GRANT_NO5, FREEZE_GRANT_AMT5, BUSI_DIVISION, DEPT_NO, CUST_MANAGER, AUDIT_CHANNEL, LOAN_SYSTEM, BATCH_STATUS, DEDUCT_AMT, LOAN_AMT, LOAN_DT, LOAN_TIME, LOAN_START_DT, ORDER_ID, PROCESS_OPER_NO, PROCESS_DT, PROCESS_TIME, AUDIT_OPER_NO, AUDIT_DT, AUDIT_TIME, ACCT_OPER_NO, ACCOUNT_DT, ACCOUNT_TIME, ACCT_FLOW_NO, DEDUCT_OPER_NO, DEDUCT_DT, DEDUCT_TIME, OPER_NO, OPER_DT, OPER_TIME, GRANT_RATIO, LOAN_NO, PLEDGE_NO, SUSPD_BRANCH_NAME, SUSPD_BRANCH_NO, YZ_SOURCE, UPDATE_DT, UPDATE_TIME, ACCT_ORDER_ID1, ACCT_ORDER_ID2, ACCT_ORDER_ID3, ACCT_ORDER_ID4, ACCT_ORDER_ID5, REFUND_ORDER_ID, REFUND_FLAG, CONFER_NO) values " +
	                "(?, ?, '0100', ' ', ' ', ' ', '030401020000000000', '测试01', '2200008660', '3', '305100001008', '中国民生银行北京分行营业部', ' ', ' ', '中国民生银行北京分行', ' ', '2016-08-10', '2017-11-29', '2', '1', 1, 25978.00, 25978.00, 0.00, 0.00, '2', 'YTS005', '0101', '中国民生银行北京分行营业部', 0.00, '0', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', '1', '1', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-25', '20161125113417', ' ', ' ', ' ', '010001', '2016-11-25', '20161125135120', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
	        String acctbalanceSql="insert into  TACCT_BALANCE (BALANCE_ID, INFO_ID, RGCT_ID, BILL_NO, START_DT, END_DT, CUST_NO, CUST_NAME, PROD_NO, STATUS, CREATE_DT, CREATE_TM, UPDATE_DT, UPDATE_TM, STORAGE_BRCH_NO, STORAGE_BRCH_NAME, ACCT_BRCH_NO, ACCT_BRCH_NAME) values " +
	                      "(?, ?, ?, ?, '2016-11-25', ' ', '2200006456', 'YTS005', '001001003', '1', '161125', '13:56:57', ' ', ' ', ' ', ' ', ' ', ' ')";
	        String discBillSql= "insert into TDISC_BILL_INFO (DISCMX_ID, BILL_TYPE, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_BRANCH_NO, BILL_MONEY, DRAWEE_ADDR, PAYEE_BANK_NO, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, DISC_ID, RGCT_ID, CUST_NO, CUST_ACCOUNT, SALER_INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, BUYER_INTEREST, PAY_MONEY, IS_SAME_CITY, REMARK, IS_AUDITED, CONFER_NO, IS_ACCPT, LIMIT_PROD_NO, RATE, RATE_TYPE, DISC_DT, DISC_TYPE, FILE_NO, NO_LOU_LOANS, IS_ONLINE, REDEEM_END_DATE, PROFESSION_ID, BANK_PROD_NO, LOCAL_PAY_MONEY, IS_AMOUNT, FORBID_FLAG, IS_THIRD_AMOUNT, OUT_APPLY_NO, BRANCH_NO, OPER_BANK_NO, YZ_SOURCE, PRODUCT_ID, OWNER_PARTY_ID, IS_CYC, IS_CANCEL, REDEEM_OPEN_DT, DISC_SQUARE_ID, IN_ACCT_NO, IN_BANK_NO, EX_SERIAL, UPDATE_DT, UPDATE_TIME, ACCOUNT_DATE, ACCOUNT_TIME, COLL_DT, BILL_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, GATH_MNEY_TYPE, GATH_MNEY_DATE, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, AUDIT_COMMIT_DATE, AUDIT_COMMIT_TIME, ACCT_COMMIT_DATE, ACCT_COMMIT_TIME, TOTAL_INTRST_PAYMENT, DELAY_TYPE, ORG_CODE, QUERY_RESULT, QUERY_CONTENT, RETURN_CONTENT, REQ_MSG_ID, IN_STORE_DT, IN_STORE_TIME, INVOICE_NO, DRAFT_PAY_MONEY, COLL_ACCOUNT_DT, PROTOCAL_NO, CHANGE_DT, CHANGE_TIME, LAST_BILL_NO, CUR_STATUS, TRANS_ID, BUYBACK_ID, TRANS_TYPE, IS_REDEEM, LIMIT_REDUCE_ROW, OWNER_PARTY_NAME, AUDIT_REASON) values " +
	                "(?, '1', '2016-08-10', '2017-11-29', '测试01', '3', '中国民生银行北京分行营业部', '305100001008', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', 25978.00, '北京金融街道1号', '305100001008', 'YTS005', '中国民生银行北京分行营业部', '2', ' ', 'YTS005', '2', '3', 'BS036', '1600014236', ?, '2200006456', '2', 108.24, 3, '2017-11-29', 5, 0.00, 25869.76, '1', ' ', ' ', ' ', '1', ' ', 30.000000, '360', '2016-11-25', '0', ' ', ' ', '0', ' ', null, ' ', 25869.76, ' ', '0', ' ', ' ', '0100', '305100001008', '0', ' ', ' ', ' ', '0', ' ', ' ', '2', '305100001008', ' ', ' ', ' ', '2016-11-25', '2016-11-25 01:56:57', ' ', ?, '010001', '010001', '010001', '1', ' ', '2016-11-25', '2016-11-25 01:56:07', '2016-11-25', '2016-11-25 01:56:19', ' ', ' ', 0.00, '0', '98988907-4', ' ', ' ', ' ', '3051000010082016112500063159', ' ', ' ', ' ', 25869.80, ' ', ' ', ' ', ' ', '00004235', '1', ' ', ' ', '1', ' ', ' ', ' ', ' ')";

	        session.execute(rcBillSql, rgctId,curHistId,billNo);
	        session.execute(rcHistSql, curHistId,rgctId);
	        session.execute(acptBillSql, acptMxId,acptId,rgctId,billNo);
	        session.execute(acptApplySql, acptId,batchNo);
	        
	        
	        session.execute(acctbalanceSql, balanceId,discMXId,rgctId,billNo);
	        session.execute(discBillSql,discMXId,rgctId,billNo);
	        String ecdsHistSQL="insert into ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) values " +
	                        "(default, 3062, '110106', 'YTS005', 'RC01', '98988907-4', '305100001008', '2', null, '1', null, '中国民生银行北京分行营业部', 'RC00', '80197796-2', '305100001008', '0', null, '0', 'RM00', '3051000010082016112500063159', '2016-11-25', '031', '2016-11-25', null, 'EM00', '"+billNo+"', 'SU00', '3051000010082016112500063160', 'SM01', null, null, null, '0.300000', '25869.80', null, null, null, null, null, null, null, '2', '305100001008', 'PS01', null, null, null, null, null, null, null)";
	        Statement stment=ecdsCon.createStatement();
	        stment.execute(ecdsHistSQL);
	        ResultSet rs=stment.executeQuery("SELECT ID FROM ECDS_BILL_HIST where idnb='"+billNo+"'");
	        if(rs.next()){
	            Long ecdsHistId=rs.getLong("ID");
	            stment.execute("insert into ECDS_BILL_INFO (IDNB, HIST_ID, COMRCLDRFT_TP, CMRCLDRFT_ISSEAMT, COMRCLDRFT_ISSEDT, COMRCLDRFT_DUEDT, COMRCLDRFT_BANENDRSMTMK, COMRCLDRFT_RMRK, DRWR_ROLE, DRWR_NM, DRWR_CMONID, DRWR_ELCTRNCSGNTR, DRWR_ACCTID, DRWR_ACCTACCTSVCR, DRWR_CDTRATGS, DRWR_CDTRATGAGCY, DRWR_CDTRATGDUEDT, ACCPTR_NM, ACCPTR_ACCTID, ACCPTR_ACCTSVCR, ACCPTR_AGCY_ACCTSVCR, ACCPTR_CMONID, PYEE_NM, PYEE_ACCTID, PYEE_ACCTSVCR, PYEE_CMONID, ACCPT_ROLE, PYEE_ROLE) values ('"+billNo+"', "+ecdsHistId+", '1', '25978.00', '2016-08-10', '2017-11-29', 'EM00', null, 'RC01', '测试01', '63618789-4', '1', '3', '305100001008', null, null, null, '中国民生银行北京分行', '0', '305100001008', null, '80197796-2', 'YTS005', '2', '305100001008', null, 'RC00', 'RC01')");
	                           

	        }
	        rs.close();
	        stment.close();

	        }
	        ecdsCon.close();
	        
	       
	        return mv;
	    }
	
	
	
	
	
	
	public Connection getEcdsConnection(){
	     String url = "jdbc:db2://192.168.1.2:50000/ecds" ;    
	     String username = "db2inst1" ;   
	     String password = "db2inst1" ;   
	     Connection con =null;
	     try{   
	         con = DriverManager.getConnection(url , username , password ) ;   
	     
	     }catch(Exception se){   
    	    System.out.println("数据库连接失败！");   
    	    se.printStackTrace() ;   
	     }  
	     return con;
	}
	
	//纸票贴现记账测试加票
	@RequestMapping(params="method=discAcctBill")
    public ModelAndView discAcctBill(int count)throws Exception{
        ModelAndView mv = new ModelAndView();
        mv.setViewName("system/xml/xml");
        ISequenceService sequenceService=ServiceFactory.getSequenceService();
        IDB session = DBFactory.getDB();
        String discBatchId=sequenceService.getPrimaryKeyValue();
        String batchNo="TX0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
 	    String discApplySql="INSERT INTO TDISC_APPLY_INFO (DISC_ID, BATCH_NO, RATE, BUY_PAY_RATE, CUST_ACCOUNT, BRANCH_NO, PAY_TYPE, PAY_BANK_NO, PAY_CUST_NAME, PAY_ACCOUNT, PROD_NO, RATE_TYPE, BILL_TYPE, BILL_CLASS, DISC_DT, CUST_MANAGER_NAME, IS_TC, AGENT_CUST_NAME, AGENT_CUST_ACCOUNT, DELAY_TYPE, REDEMPTION_DT, DEPT_NO, CREATE_TIME, DEPT_NAME, REDEEM_DATE, CUST_NAME, TRUSTEE_NAME, TRUSTEE_ACCT, TRUSTEE_BANK_NAME, TRUSTEE_BANK_NO, PROF_OWNER_NO, PROF_OWNER, BILL_OWNER, WORKINGADS_NO1, CB_RATE, BANK_PROD_NO, WORKINGADS_NO, SIGN_BRANCH_NO, CUST_MANAGE, CUST_NO, PAY_ACCOUNT_TYPE, ORDER_ID, CUST_ACCOUNT_TYPE, ACCT_BRANCH_NO, PROD_BUSI_TYPE, CREATE_DT, APPLY_STATUS, PROFESSION_NAME) VALUES (?, ?, 2.000000, 0.000000, '2', '0100', '2', ' ', ' ', ' ', '001001003', '360', '1', '1', '2016-11-22', '客户经理2', ' ', ' ', ' ', ' ', ' ', ' ', '20161122112251', '客户部测试', ' ', 'YTS005', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', '2', '2200006456', ' ', ' ', '7', ' ', ' ', '2016-11-22', '1', '零售业')";
 	    session.execute(discApplySql, discBatchId,batchNo);
 	    for(int i=0;i<count;i++){
        String billNo="1255555"+sequenceService.getPrimaryKeyValue();
        String discBillId=sequenceService.getPrimaryKeyValue();
        String rgctId=sequenceService.getPrimaryKeyValue();
        String rgctHistId=sequenceService.getPrimaryKeyValue();
	    String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES (?, ?, ' ', ' ', ' ', '3031201611222016015555555555', '1', '1', ?, '2016-11-22', '0', '测试', ' ', '123', ' ', ' ', '中国光大银行', '中国光大银行', '303100000006', ' ', '北京朝阳区惠新西街3号', 'qq', '123', ' ', '123', '中国光大银行', ' ', ' ', ' ', '中国光大银行', ' ', ' ', ' ', 'ss', ' ', ' ', 123456.00, '2016-11-30', ' ', ' ', ' ', ' ', ' ', 'ss', ' ', ' ', ' ', '2016-11-23', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', ' ', ' ', ' ', ' ', 'F_11', '0100', ' ', ' ')";
	    String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'F_11', ' ', ' ', ' ', ' ', '2200006456', ' ', ' ', ' ', ' ', '中国民生银行北京分行', ' ', ' ', '305100001008', '00010100', ' ', ' ', 0.000000, 0.00, 0.00, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2', ' ', ' ', ' ', ' ', '2', ' ', ' ', ' ', ' ', ' ', '0', ' ', ' ', '手动录入签收', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', '1', ' ', 0, 0.00, ' ', ' ', ' ', ' ', ' ', ' ', '0100', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
	    String discBillSql="INSERT INTO TDISC_BILL_INFO (DISCMX_ID, BILL_TYPE, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_BRANCH_NO, BILL_MONEY, DRAWEE_ADDR, PAYEE_BANK_NO, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, DISC_ID, RGCT_ID, CUST_NO, CUST_ACCOUNT, SALER_INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, BUYER_INTEREST, PAY_MONEY, IS_SAME_CITY, REMARK, IS_AUDITED, CONFER_NO, IS_ACCPT, LIMIT_PROD_NO, RATE, RATE_TYPE, DISC_DT, DISC_TYPE, FILE_NO, NO_LOU_LOANS, IS_ONLINE, REDEEM_END_DATE, PROFESSION_ID, BANK_PROD_NO, LOCAL_PAY_MONEY, IS_AMOUNT, FORBID_FLAG, IS_THIRD_AMOUNT, OUT_APPLY_NO, BRANCH_NO, OPER_BANK_NO, YZ_SOURCE, PRODUCT_ID, OWNER_PARTY_ID, IS_CYC, IS_CANCEL, REDEEM_OPEN_DT, DISC_SQUARE_ID, IN_ACCT_NO, IN_BANK_NO, EX_SERIAL, UPDATE_DT, UPDATE_TIME, ACCOUNT_DATE, ACCOUNT_TIME, COLL_DT, BILL_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, GATH_MNEY_TYPE, GATH_MNEY_DATE, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, AUDIT_COMMIT_DATE, AUDIT_COMMIT_TIME, ACCT_COMMIT_DATE, ACCT_COMMIT_TIME, TOTAL_INTRST_PAYMENT, DELAY_TYPE, ORG_CODE, QUERY_RESULT, QUERY_CONTENT, RETURN_CONTENT, REQ_MSG_ID, IN_STORE_DT, IN_STORE_TIME, INVOICE_NO, DRAFT_PAY_MONEY, COLL_ACCOUNT_DT, PROTOCAL_NO, CHANGE_DT, CHANGE_TIME, LAST_BILL_NO, CUR_STATUS, TRANS_ID, BUYBACK_ID, TRANS_TYPE, IS_REDEEM, LIMIT_REDUCE_ROW, OWNER_PARTY_NAME, AUDIT_REASON) VALUES (?, '1', '2016-11-22', '2016-11-30', '测试', '123', '中国光大银行', '303100000006', '中国光大银行', ' ', ' ', '中国光大银行', ' ', 123456.00, '北京朝阳区惠新西街3号', ' ', 'qq', '123', '123', 'ss', ' ', '1', '2', 'BS031', ?, ?, '2200006456', '2', 54.87, 3, '2016-11-30', 8, 0.00, 123401.13, '1', 'ss', ' ', ' ', '0', ' BS012', 2.000000, '360', '2016-11-23', '0', ' ', ' ', ' ', ' ', null, ' ', 123401.13, ' ', ' ', ' ', ' ', '0100', ' ', '0', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ?, ' ', '010001', ' ', ' ', ' ', '2016-11-23', '2016-11-22 10:11:50', '2016-11-22', '2016-11-22 10:12:34', ' ', ' ', 0.00, '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', 'ss', ' ', ' ', '55555555', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
	    session.execute(rcBillSql, rgctId,rgctHistId,billNo);
	    session.execute(rcHistSql, rgctHistId,rgctId);
	    session.execute(discBillSql, discBillId,discBatchId,rgctId,billNo);
	        
	    }
	    return mv;
	}
		
		//纸票转入记账测试加票
		@RequestMapping(params="method=rebuyAcctBill")
		public ModelAndView rebuyAcctBill(int count)throws Exception{
			ModelAndView mv = new ModelAndView();
		    mv.setViewName("system/xml/xml");
	        ISequenceService sequenceService=ServiceFactory.getSequenceService();
	        IDB session = DBFactory.getDB();
	        String rebuyBatchId=sequenceService.getPrimaryKeyValue();
	        String batchNo="ZR0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
	        String rebuyApplySql="INSERT INTO TREBUY_APPLY_INFO (REBUY_ID, BATCH_NO, PROD_NO, BILL_TYPE, BILL_CLASS, REBUY_DT, RESALE_DUE_DT, RATE, RATE_TYPE, DELAY_TYPE, IS_DUMMY, IS_INNER, BIDECT_DUE_DT, DELAY_DAYS, IS_BIDIR_SALE, CUST_MANAGER_NAME, DEPT_NO, CREATE_DT, CREATE_TIME, DEPT_NAME, PROF_OWNER_NO, PROF_OWNER, CUST_NAME, DISC_TYPE, PRODUCT_ATTS, CB_RATE, FILE_NO, BILL_STORAGE_ORG, RESALE_STA_DT, SALEBACK_RATE, SALEBACK_MONEY, SALEBACK_RATE_TYPE, CUST_MANAGE, IS_ONLINE, BILL_STORAGE_ORG_NAME, IS_REDISC_CENTER, BUSI_BRANCH_NO, BUSI_BRANCH_NAME, ENDORSES_BANK_NO, BUSI_BRCH_BANK_NO, CUST_NO, CUST_TYPE, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, REMARK, CUST_ACCOUNT, CUST_BRANCH_NO, CUST_BRANCH_NAME, CUST_BANK_NO, CUST_BANK_NAME, TRADE_ACCT, TRADE_ACCT_NAME, SALE_ID, PROD_ATTR, BRANCH_NO, TRADE_ACCT_TYPE, TRADE_ACCT_ORG, CUST_ORG_CODE, ORDER_ID, APPLY_STATUS) VALUES (?, ?, '001002006', '1', '1', '2016-11-23', ' ', 2.000000, '360', ' ', ' ', '0', ' ', ' ', ' ', '客户经理2', ' ', '2016-11-23', '2016-11-22 01:38:31', '客户部测试', ' ', ' ', ' ', '0', ' ', 2.000000, ' ', ' ', ' ', 0.000000, 0.00, ' ', '2', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '303100000006', '中国光大银行', '2', 'YTS005', ' ', ' ', '0100', ' ', ' ', ' ', ' ', '1')";
	        session.execute(rebuyApplySql, rebuyBatchId,batchNo);
	        for(int i=0;i<count;i++){
	        String billNo="1255555"+sequenceService.getPrimaryKeyValue();
	        String rebuyBillId=sequenceService.getPrimaryKeyValue();
	        String rgctId=sequenceService.getPrimaryKeyValue();
	        String rgctHistId=sequenceService.getPrimaryKeyValue();
	        String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES (?, ?, ' ', ' ', ' ', '3031 3112555555555555', '1', '1', ?, ' ', '0', 'w', ' ', 'w', ' ', '303100000006', '中国光大银行', '中国光大银行', '303100000006', ' ', '北京朝阳区惠新西街3号', 'w', 'w', ' ', 'w', '中国光大银行', ' ', ' ', '303100000006', '中国光大银行', ' ', ' ', ' ', ' ', ' ', ' ', 89895.00, '2016-11-30', ' ', ' ', ' ', ' ', ' ', 'q', ' ', ' ', ' ', '2016-11-23', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, '2016-11-22', ' ', ' ', ' ', ' ', ' ', 'I_08', ' ', ' ', ' ')";
	        String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'I_08', ' ', ' ', ' ', ' ', ' ', ' ', '303100000006', ' ', ' ', '中国民生银行北京分行', ' ', '0', '305100001008', '0100', ' ', ' ', 0.000000, 0.00, 0.00, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, '0', '1', ' ', ' ', ' ', ' ', '中国民生银行北京分行', '0', '305100001008', ' ', ' ', '303100000006', ' ', ' ', ' ', '2016-11-22 01:41:01', '010001', ' ', '0', ' ', ' ', '手工转入受理录入', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2', ' ', ' ', ' ', '0', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-23', ' ')";
	        String rebuyBillSql="INSERT INTO TREBUY_BILL_INFO (REBUYMX_ID, BILL_TYPE, BILL_NO, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, BILL_MONEY, ACCEPTOR, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, REBUY_ID, RGCT_ID, CUST_ACCOUNT, IS_SAME_CITY, INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, PAY_MONEY, REMARK, CREATE_DATE, CREATE_TIME, IS_AUDITED, DRAWEE_ADDR, PAYEE_BANK_NO, CONFER_NO, IS_ACCPT, IS_INNER, LIMIT_BILL_ID, LIMIT_PROD_NO, RATE, RATE_TYPE, REMITTER_CUST_NO, CHANNEL, IS_DELAY_IN, SALE_ID, IS_ONLINE, FORBID_FLAG, REBUY_DT, RESALE_STA_DT, RESALE_DUE_DT, LIMIT_TYPE, LIMIT_NO, BILL_STORAGE_ORG, YZ_SOURCE, PROD_NO, OWNER_PARTY_ID, IS_CYC, PRODUCT_NAME, OWNER_PARTY_NAME, IS_CYC_NAME, EX_SERIAL, IS_BUYBACK, REBUY_SQUARE_ID, IS_REDISC_CENTER, PAY_TRADE_NO, BEGIN_DATE, CHECK_INTEREST, CUST_NO, CUST_BANK_NO, CUST_BANK_NAME, DELAY_TYPE, IS_REGRESS, FAC_MSG, IS_AMOUNT, ENDORSES_BANK_NO, FAC_OPER_TYPE, COLL_DATE, ACCOUNT_DATE, ACCOUNT_TIME, TOTAL_INTRST_PAYMENT, GATH_DATE, GATH_TYPE, ENDORSES_BANK_NAME, SALEMX_ID, CHECK_PAY_MONEY, ADJUST_FLAG, INTEREST_SALEBACK1, PAYMONEY_SALEBACK1, APPLY_CANCEL_FLAG, REQ_DRAFT_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, CUST_ORG_CODE, POSITION, CUST_TYPE, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, CUR_STATUS, TRANS_ID, TRANS_TYPE, BUYBACK_ID, IS_ELEC_DEPOSIT, ZC_SOURCE, ZC_SOURCE_ID, LIMIT_REDUCE_ROW, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, BRANCH_NO, OPER_BANK_NO, AUDIT_REASON) VALUES (?, '1', ?, '2016-11-22', '2016-11-30', 'w', 'w', '中国光大银行', '303100000006', 89895.00, '中国光大银行', 'w', 'w', 'w', 'q', ' ', '1', '2', 'BS131', ?, ?, ' ', '1', 3495.94, 3, '2016-11-30', 7, 8986052.06, 'q', '2016-11-23', '2016-11-22 01:41:00', ' ', '北京朝阳区惠新西街3号', ' ', ' ', '0', '0', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', '0', '0', '2016-11-23', ' ', ' ', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '0', ' ', '0', ' ', ' ', 0.00, ' ', '303100000006', '中国光大银行', '0', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', 0.00, 0.00, '0', ' ', '010001', '010001', ' ', ' ', ' ', ' ', '303100000006', '中国光大银行', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-23', '2016-11-22 01:41:54', '0100', ' ', ' ')";
	        session.execute(rcBillSql, rgctId,rgctHistId,billNo);
	        session.execute(rcHistSql, rgctHistId,rgctId);
	        session.execute(rebuyBillSql, rebuyBillId,billNo,rebuyBatchId,rgctId);
	        
	        }
	        return mv;
	    }
		//纸票转卖记账测试加票
		@RequestMapping(params="method=saleAcctBill")
		public ModelAndView saleAcctBill(int count)throws Exception{
			ModelAndView mv = new ModelAndView();
			mv.setViewName("system/xml/xml");
			ISequenceService sequenceService=ServiceFactory.getSequenceService();
	        IDB session = DBFactory.getDB();
	        String saleBatchId=sequenceService.getPrimaryKeyValue();
	        String batchNo="ZC0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
	        String saleApplySql="INSERT INTO TSALE_APPLY_INFO (SALE_ID, BATCH_NO, AIM_BRANCH_NO, PROD_NO, BILL_TYPE, BILL_CLASS, INNER_ACCOUNT, SALE_DT, SALE_TIME, REBUY_DUE_DT, RATE, RATE_TYPE, DELAY_TYPE, IS_DUMMY, IS_INNER, BIDECT_DUE_DT, DELAY_DAYS, BRANCH_ID, IF_BIDIR_BUY, STATUS, CREATE_DT, CREATE_TIME, OPER_NO, BATCH_TYPE, IS_REDISC, SALE_TYPE, BUYBACK_RATE, BUYBACK_OPEN_DT, BUYBACK_MONEY, IS_ONLINE, MOCK_AIM_NAME, PROD_ATTR, CUST_NAME, FINANCIAL_CUST_NO, CUST_BANK_NAME, CUST_BANK_NO, FACT_BANK_NO, FACT_BANK_NAME, FORBID_FLAG, BRANCH_NO, CUST_TYPE, BILL_STORAGE_BRCHNO, BILL_STORAGE_NAME, BILL_STORAGE_BRCHID, CUST_NO, PROD_ATTR_NO, IN_ACCT_NO, IN_ACCT_TYPE, IN_ACCT_NAME, BILL_POSITION_BRANCH, CUST_MANAGE, CUST_MANAGER_NAME, DEPT_NO, DEPT_NAME, WORKINGADS_NO, WORKINGADS_NAME, ORDER_ID, APPLY_STATUS) VALUES (?, ?, '303100000006', '001003002', '1', '1', ' ', '2016-11-22', ' ', ' ', 0.000000, '360', ' ', '0', '0', ' ', ' ', ' ', '0', ' ', '2016-11-23', '12:49:35', '010001', ' ', '0', '0', 0.000000, ' ', 0.00, '0', ' ', ' ', '中国光大银行', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '1', '0100', '中国民生银行北京分行', '00010100', ' ', ' ', '2', '1', 'YTS005', ' ', '2', '客户经理2', ' ', '客户部测试', ' ', ' ', ' ', '1')";
	        session.execute(saleApplySql, saleBatchId,batchNo);
	        for(int i=0;i<count;i++){
			    String billNo="1255555"+sequenceService.getPrimaryKeyValue();
			    String discBillId=sequenceService.getPrimaryKeyValue();
		        String saleBillId=sequenceService.getPrimaryKeyValue();
			    String rgctId=sequenceService.getPrimaryKeyValue();
			    String rgctHistId=sequenceService.getPrimaryKeyValue();
			    String balanceId=sequenceService.getPrimaryKeyValue();
			    String discSql="INSERT INTO TDISC_BILL_INFO (DISCMX_ID, BILL_TYPE, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_BRANCH_NO, BILL_MONEY, DRAWEE_ADDR, PAYEE_BANK_NO, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, DISC_ID, RGCT_ID, CUST_NO, CUST_ACCOUNT, SALER_INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, BUYER_INTEREST, PAY_MONEY, IS_SAME_CITY, REMARK, IS_AUDITED, CONFER_NO, IS_ACCPT, LIMIT_PROD_NO, RATE, RATE_TYPE, DISC_DT, DISC_TYPE, FILE_NO, NO_LOU_LOANS, IS_ONLINE, REDEEM_END_DATE, PROFESSION_ID, BANK_PROD_NO, LOCAL_PAY_MONEY, IS_AMOUNT, FORBID_FLAG, IS_THIRD_AMOUNT, OUT_APPLY_NO, BRANCH_NO, OPER_BANK_NO, YZ_SOURCE, PRODUCT_ID, OWNER_PARTY_ID, IS_CYC, IS_CANCEL, REDEEM_OPEN_DT, DISC_SQUARE_ID, IN_ACCT_NO, IN_BANK_NO, EX_SERIAL, UPDATE_DT, UPDATE_TIME, ACCOUNT_DATE, ACCOUNT_TIME, COLL_DT, BILL_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, GATH_MNEY_TYPE, GATH_MNEY_DATE, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, AUDIT_COMMIT_DATE, AUDIT_COMMIT_TIME, ACCT_COMMIT_DATE, ACCT_COMMIT_TIME, TOTAL_INTRST_PAYMENT, DELAY_TYPE, ORG_CODE, QUERY_RESULT, QUERY_CONTENT, RETURN_CONTENT, REQ_MSG_ID, IN_STORE_DT, IN_STORE_TIME, INVOICE_NO, DRAFT_PAY_MONEY, COLL_ACCOUNT_DT, PROTOCAL_NO, CHANGE_DT, CHANGE_TIME, LAST_BILL_NO, CUR_STATUS, TRANS_ID, BUYBACK_ID, TRANS_TYPE, IS_REDEEM, LIMIT_REDUCE_ROW, OWNER_PARTY_NAME, AUDIT_REASON) VALUES (?, '1', '2016-11-22', '2016-11-30', '2', '2', '中国光大银行', '303100000006', '中国光大银行', ' ', ' ', '中国光大银行', ' ', 22222.00, '北京朝阳区惠新西街3号', ' ', '2', '2', '2', 'qq', ' ', '1', '2', 'BS041', '1600009187', ?, '2200006456', '2', 9.88, 3, '2016-11-30', 8, 0.00, 22212.12, '1', 'qq', ' ', ' ', '0', ' BS012', 2.000000, '360', '2016-11-23', '0', ' ', ' ', ' ', ' ', null, ' ', 22212.12, ' ', ' ', ' ', ' ', '0100', ' ', '0', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-11-23', '2016-11-22 10:52:12', ' ', ?, ' ', '010001', ' ', '1', ' ', '2016-11-23', '2016-11-22 10:52:45', '2016-11-23', '2016-11-22 10:49:12', ' ', ' ', 0.00, '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', 'qq', ' ', ' ', '55555555', '1', ' ', ' ', '1', ' ', ' ', ' ', ' ')";
			    String balanceSql="INSERT INTO TACCT_BALANCE (BALANCE_ID, INFO_ID, RGCT_ID, BILL_NO, START_DT, END_DT, CUST_NO, CUST_NAME, PROD_NO, STATUS, CREATE_DT, CREATE_TM, UPDATE_DT, UPDATE_TM, STORAGE_BRCH_NO, STORAGE_BRCH_NAME, ACCT_BRCH_NO, ACCT_BRCH_NAME) VALUES (?, '1600009188', ?, ?, '2016-11-23', ' ', '2200006456', 'YTS005', '001001003', '1', '161122', '10:52:12', ' ', ' ', ' ', ' ', ' ', ' ')";
		        String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES (?, ?, ' ', ' ', ' ', '3031201611222016595555555555', '1', '1', ?, '2016-11-22', '0', '2', ' ', '2', ' ', ' ', '中国光大银行', '中国光大银行', '303100000006', ' ', '北京朝阳区惠新西街3号', '2', '2', ' ', '2', '中国光大银行', ' ', ' ', ' ', '中国光大银行', ' ', ' ', ' ', 'qq', ' ', ' ', 22222.00, '2016-11-30', ' ', ' ', ' ', ' ', ' ', 'qq', ' ', ' ', ' ', '2016-11-23', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', ' ', ' ', ' ', ' ', 'I_11', '0100', '0100', ' ')";
		        String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'I_11', 'F_02', ' ', ' ', '中国民生银行北京分行', '2200006456', '0', '305100001008', '0100', ' ', '中国光大银行', ' ', '0', '303100000006', ' ', '2016-11-23', ' ', 0.000000, 0.00, 22222.00, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, '0', ' ', ' ', ' ', ' ', ' ', '中国民生银行北京分行', '0', '305100001008', ' ', ' ', ' ', '2', ' ', ' ', '2016-11-23', ' ', '2', '0', ' ', ' ', '买断式转贴现', '1600009198', '1600009198', '0', ' ', ' ', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.020000, '2016-11-23', '3', ' ', '1', '0', '2016-11-30', 8, 0.00, ' ', ' ', ' ', ' ', 'YTS005', ' ', '0100', '0100', '1', ' ', ' ', '中国民生银行北京分行', '1600009198', ' ', ' ', '2016-11-23', 'F_02')";
		        String saleBillSql="INSERT INTO TSALE_BILL_INFO (SALEMX_ID, BILL_TYPE, BILL_NO, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_CUST_NO, REMITTER_BANK_NAME, REMITTER_BANK_NO, BILL_MONEY, ACCEPTOR, PAYEE_NAME, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, SALE_ID, RGCT_ID, BRANCH_NO, CUST_ACCOUNT, IS_SAME_CITY, INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, RECEIVE_MONEY, REMARK, CREATE_DATE, CREATE_TIME, DRAWEE_ADDR, PAYEE_BANK_NO, IS_ACCPT, RATE, RATE_TYPE, BUY_DEPT_NO, SALE_PRACT_ID, BUYBACK_MONEY, IS_ONLINE, FORBID_FLAG, BILL_SOURCE_ID, IS_DELAY_IN, EX_SERIAL, IS_BUYBACK, SALE_SQUARE_ID, YZ_SOURCE, BIDIR_SALE_HIST_FLAG, PAY_TRADE_NO, BUY_MONEY, PRIOR_SRC, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, APPLY_TELLER_DT, APPLY_TELLER_TIME, AUDIT_TELLER_DT, AUDIT_TELLER_TIME, ACCT_TELLER_DT, ACCT_TELLER_TIME, GATH_MNEY_DATE, ACCOUNT_DATE, CUST_MANAGE, CUST_MANAGE_DEPT_NO, WORK_BRANCH_NO, COST_RATE, DELAY_TYPE, BILL_STORAGE_ORG, IS_INNER, RESALE_DUE_DT, INTEREST_BUYBACK, PAYMONEY_BUYBACK, PRIOR_SRC_ID, BUY_TYPE, CUST_MANAGE_NAME, CUST_MANAGE_DEPT_NAME, WORK_BRANCH_NAME, RESALE_OPEN_DT, OLD_RATE, OLD_GALE_DATE, BATCH_ID, OLD_INTEREST, OLD_INST_CAL_DAYS, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, OLD_DISC_DT, OLD_FILE_NO, CUR_STATUS, IF_RECOURS_AVIOD, AUDIT_REASON) VALUES (?, '1', ?, '2016-11-22', '2016-11-30', '2', '2', ' ', '中国光大银行', ' ', 22222.00, '中国光大银行', '2', '2', '2', 'YTS005', ' ', '1', '1', 'BS222', ?, ?, '00010100', ' ', '0', 0.00, 3, '2016-11-30', 8, 22222.00, 'qq', '2016-11-23', '13:05:35', '北京朝阳区惠新西街3号', ' ', '0', 0.000000, '360', ' ', ' ', 0.000000, '0', ' ', ' ', '0', ' ', '0', ' ', '0', '0', ' ', 0.00, '1', '010001', '010001', ' ', '2016-11-23', '13:06:04', '2016-11-23', '13:06:20', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, '0', ' ', '0', ' ', 0.00, 0.00, ?, '1', ' ', ' ', ' ', ' ', 2.000000, '2016-11-30', ' ', 9.88, 8, ' ', '中国光大银行', '2016-11-22', ' ', ' ', ' ', ' ')";
		        session.execute(discSql, discBillId,rgctId,billNo);
		        session.execute(balanceSql, balanceId,rgctId,billNo);
		        session.execute(rcBillSql, rgctId,rgctHistId,billNo);
		        session.execute(rcHistSql, rgctHistId,rgctId);
		        session.execute(saleBillSql, saleBillId,billNo,saleBatchId,rgctId,discBillId);
		        }
		        return mv;
		    }
			
		
		/*
		 * 电票贴现生成贴现记帐的票据
		 */
		@RequestMapping(params="method=discEleGernateBill")

		public ModelAndView discEleGernateBill(int count)throws Exception{
	        ModelAndView mv = new ModelAndView();
	        mv.setViewName("system/xml/xml");
	        ISequenceService sequenceService=ServiceFactory.getSequenceService();
	        IDB session = DBFactory.getDB();
	        Connection ecdsCon=getEcdsConnection();
	        String workDt=DateTimeUtil.getEcds_YYYY_MM_DD_Date().toString();
	        String discApplyId=sequenceService.getPrimaryKeyValue();
	        String discBatchNo="TX0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
	        String discApplySql="INSERT INTO TDISC_APPLY_INFO (DISC_ID, BATCH_NO, RATE, BUY_PAY_RATE, CUST_ACCOUNT, BRANCH_NO, PAY_TYPE, PAY_BANK_NO, PAY_CUST_NAME, PAY_ACCOUNT, PROD_NO, RATE_TYPE, BILL_TYPE, BILL_CLASS, DISC_DT, CUST_MANAGER_NAME, IS_TC, AGENT_CUST_NAME, AGENT_CUST_ACCOUNT, DELAY_TYPE, REDEMPTION_DT, DEPT_NO, CREATE_TIME, DEPT_NAME, REDEEM_DATE, CUST_NAME, TRUSTEE_NAME, TRUSTEE_ACCT, TRUSTEE_BANK_NAME, TRUSTEE_BANK_NO, PROF_OWNER_NO, PROF_OWNER, BILL_OWNER, WORKINGADS_NO1, CB_RATE, BANK_PROD_NO, WORKINGADS_NO, SIGN_BRANCH_NO, CUST_MANAGE, CUST_NO, PAY_ACCOUNT_TYPE, ORDER_ID, CUST_ACCOUNT_TYPE, ACCT_BRANCH_NO, PROD_BUSI_TYPE, CREATE_DT, APPLY_STATUS, PROFESSION_NAME, ENTERPRISE_SCALE, IS_RURAL_ENTERPRISES, SOCIAL_CREDIT_CODE) VALUES (?, ?, 30.000000, 0.000000, '2', '0100', '2', ' ', ' ', ' ', '001001003', '360', '1', '2', '2016-11-24', '客户经理2', ' ', ' ', ' ', ' ', ' ', ' ', '20161124094234', '客户部测试', ' ', 'YTS005', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 3.000000, ' ', ' ', ' ', '2', '2200006456', '7', ' ', '7', ' ', ' ', '2016-11-24', '2', '农、林、渔、牧业', null, null, null)";    
	        session.execute(discApplySql,discApplyId,discBatchNo);
	        for(int i=0;i<count;i++){
	        	String billNo="13051000010082016111"+sequenceService.getPrimaryKeyValue();
		        String acptBillId=sequenceService.getPrimaryKeyValue();
		        String acptBatchId=sequenceService.getPrimaryKeyValue();
		        String rgctId=sequenceService.getPrimaryKeyValue();
		        String curHistId=sequenceService.getPrimaryKeyValue();
		        String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES (?, ?, '', ' ', '', '30512016130510000100820160810100003584', '2', '1', ?, '2016-08-10', '1', '测试01', '2200008660', '3', '1', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', '305100001008', ' ', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', ' ', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', 8726.00, '2016-12-26', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '150405', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', 'RC01', '63618789-4', '80197796-2', '98988907-4', 'C_02', ' ', ' ', ' ')";
		        String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'C_02', 'C_08', ' ', ' ', '测试01', '2200008660', '3', '305100001008', ' ', '2', 'YTS005', '2200006456', '2', '305100001008', ' ', '2016-11-22', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '1', '1', '2200006456', 'YTS005', '2', '305100001008', 'YTS005', ' ', '305100001008', '2', ' ', ' ', '2016-11-22', ' ', ' ', '0', ' ', ' ', '提示收票回复', '1600009779', '1600009779', ' ', ' ', '1', '1600009783', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, '63618789-4', '98988907-4', 'RC01', 'RC01', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '1600009786', ' ', ' ', '2016-11-22', 'C_02')";
		        //银票
		        String acptBillSql="INSERT INTO TACPT_BILL_INFO (ACPTMX_ID, ACPT_ID, RGCT_ID, ESNO, BRANCH_NO, PROTOCAL_NO, FAC_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BRANCH_NO, REMITTER_BANK_NO, REMITTER_BANK_NAME, BILL_CLASS, BILL_TYPE, VOUCHER_TYPE, BILL_NO, BILL_MONEY, CURRENCY_CATEGORY, BILL_STATUS, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, PAYEE, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, DUE_DT, ISSUE_DT, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, COLLTN_STATUS, COLLTN_ID, SSPD_STATUS, SSPD_ID, PRINT_STATUS, PRSNTTN_ACCT_NO, PRSNTTN_NAME, PRSNTTN_BANK_NO, PRSNTTN_BANK_NAME, PAYMENT_PATH, PAYMENT_DT, CUST_REMARK, BANK_REMARK, PAY_WAIT_ORDER, TXL_CTRCT_NB, INVC_NB, REAL_ACCT_DT, REAL_ACCT_TIME, DRWG_BCK_OPER_NO, DRWG_BCK_DT, DRWG_BCK_TIME, DRWG_BCK_FLOW_NO, STATUS, APPLY_CANCEL_FLAG, REQUEST_MSG_ID, YZ_SOURCE, CONFER_NO, ACPT_DT) VALUES (?, ?, ?, 0, '0100', ' ', ' ', '测试01', '2200008660', '3', '0100', '305100001008', '中国民生银行北京分行营业部', '2', '1', '090', ?, 8726.00, 'RMB', '1', '305100001008', '中国民生银行北京分行', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '2016-12-26', '2016-08-10', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-12-26', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'BS436', ' ', '3051000010082016112200062725', ' ', ' ', '20161122')";
		        String batchNo="YC0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
		        String acptApplySql="INSERT INTO TACPT_APPLY_INFO (ACPT_ID, BATCH_NO, BRANCH_NO, PROTOCAL_NO, FAC_NO, FKJJH, PROD_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BANK_NO, REMITTER_BANK_NAME, ISSUE_BRANCH_NO, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, ISSUE_DT, DUE_DT, BILL_CLASS, BILL_TYPE, TOTAL_COUNT, TOTAL_AMT, TOTAL_AMT_FOR_DEDUCT, TOTAL_GRANT_AMT, FREEZE_TOTAL_GRANT_AMT, ACCOUNT_NO1, ACCOUNT_NAME1, ACCOUNT_BRANCH_NO1, ACCOUNT_BRANCH_NAME1, GRANT_AMT1, ACCOUNT_TYPE1, GRANT_NO1, FREEZE_GRANT_AMT1, ACCOUNT_NO2, ACCOUNT_NAME2, ACCOUNT_BRANCH_NO2, ACCOUNT_BRANCH_NAME2, GRANT_AMT2, ACCOUNT_TYPE2, GRANT_NO2, FREEZE_GRANT_AMT2, ACCOUNT_NO3, ACCOUNT_NAME3, ACCOUNT_BRANCH_NO3, ACCOUNT_BRANCH_NAME3, GRANT_AMT3, ACCOUNT_TYPE3, GRANT_NO3, FREEZE_GRANT_AMT3, ACCOUNT_NO4, ACCOUNT_NAME4, ACCOUNT_BRANCH_NO4, ACCOUNT_BRANCH_NAME4, GRANT_AMT4, ACCOUNT_TYPE4, GRANT_NO4, FREEZE_GRANT_AMT4, ACCOUNT_NO5, ACCOUNT_NAME5, ACCOUNT_BRANCH_NO5, ACCOUNT_BRANCH_NAME5, GRANT_AMT5, ACCOUNT_TYPE5, GRANT_NO5, FREEZE_GRANT_AMT5, BUSI_DIVISION, DEPT_NO, CUST_MANAGER, AUDIT_CHANNEL, LOAN_SYSTEM, BATCH_STATUS, DEDUCT_AMT, LOAN_AMT, LOAN_DT, LOAN_TIME, LOAN_START_DT, ORDER_ID, PROCESS_OPER_NO, PROCESS_DT, PROCESS_TIME, AUDIT_OPER_NO, AUDIT_DT, AUDIT_TIME, ACCT_OPER_NO, ACCOUNT_DT, ACCOUNT_TIME, ACCT_FLOW_NO, DEDUCT_OPER_NO, DEDUCT_DT, DEDUCT_TIME, OPER_NO, OPER_DT, OPER_TIME, GRANT_RATIO, LOAN_NO, PLEDGE_NO, SUSPD_BRANCH_NAME, SUSPD_BRANCH_NO, YZ_SOURCE, UPDATE_DT, UPDATE_TIME, ACCT_ORDER_ID1, ACCT_ORDER_ID2, ACCT_ORDER_ID3, ACCT_ORDER_ID4, ACCT_ORDER_ID5, REFUND_ORDER_ID, REFUND_FLAG, CONFER_NO) VALUES (?, ?, '0100', ' ', ' ', ' ', '030401020000000000', '测试01', '2200008660', '3', '305100001008', '中国民生银行北京分行营业部', '0100', '305100001008', '中国民生银行北京分行', '北京金融街道1号', '2016-08-10', '2016-12-26', '2', '1', 1, 8726.00, 8726.00, 0.00, 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', '1', ' ', ' ', ' ', ' ', ' ', ' ', '010001', ' ', '20161122152538', ' ', ' ', ' ', '010001', '2016-11-22', '20161122152845', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
		        String discXML="<?xml version=\"1.0\" encoding=\"UTF-8\"?><Document><functionId>106101</functionId><exSerial>122</exSerial><bankNo>" +
		        		"</bankNo><branchNo></branchNo><channel></channel><operator></operator><authOper></authOper><authPwd></authPwd>" +
		        		"<applyDate>"+workDt+"</applyDate><applyTime></applyTime><reserve></reserve><reserve1></reserve1><billList><bean>" +
		        		"<discType>0</discType><discRate>0.3</discRate><discMoney>1093.4</discMoney><settlementMark>0</settlementMark><inAcctNo>2</inAcctNo>" +
		        		"<inBankNo>305100001008</inBankNo><applicantAcctNo>2</applicantAcctNo><discDt>"+workDt+"</discDt><signature>1</signature>" +
		        		"<rgctId>"+rgctId+"</rgctId><banEndorsementMark>0</banEndorsementMark><receiverAcctNo>0</receiverAcctNo><receiverBankNo>305100001008" +
		        		"</receiverBankNo><receiverName>中国民生银行北京分行营业部</receiverName><batchNo>1</batchNo><conferNo>1</conferNo><invoiceNo>1</invoiceNo>" +
		        		"<remark>1</remark></bean></billList></Document>";
		        session.execute(rcBillSql, rgctId,curHistId,billNo);
		        session.execute(rcHistSql, curHistId,rgctId);
		        session.execute(acptApplySql, acptBatchId,batchNo);
		        session.execute(acptBillSql, acptBillId,acptBatchId,rgctId,billNo);
		        String ecdsHistSQL="INSERT INTO ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) VALUES (default, 2535, '030006', '测试01', 'RC01', '63618789-4', '305100001008', '3', null, '2', null, 'YTS005', 'RC01', '98988907-4', '305100001008', '2', null, '1', null, '3051000010082016112200062728', '2016-11-22', '031', '2016-11-22', null, null, '"+billNo+"', 'SU00', '3051000010082016112200062729', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 'PS01', null, null, null, null, null, null, null)";
		        Statement stment=ecdsCon.createStatement();
		        stment.execute(ecdsHistSQL);
		        ResultSet rs=stment.executeQuery("SELECT ID FROM ECDS_BILL_HIST where idnb='"+billNo+"'");
		        if(rs.next()){
		            Long ecdsHistId=rs.getLong("ID");
		            stment.execute("INSERT INTO ECDS_BILL_INFO (IDNB, HIST_ID, COMRCLDRFT_TP, CMRCLDRFT_ISSEAMT, COMRCLDRFT_ISSEDT, COMRCLDRFT_DUEDT, COMRCLDRFT_BANENDRSMTMK, COMRCLDRFT_RMRK, DRWR_ROLE, DRWR_NM, DRWR_CMONID, DRWR_ELCTRNCSGNTR, DRWR_ACCTID, DRWR_ACCTACCTSVCR, DRWR_CDTRATGS, DRWR_CDTRATGAGCY, DRWR_CDTRATGDUEDT, ACCPTR_NM, ACCPTR_ACCTID, ACCPTR_ACCTSVCR, ACCPTR_AGCY_ACCTSVCR, ACCPTR_CMONID, PYEE_NM, PYEE_ACCTID, PYEE_ACCTSVCR, PYEE_CMONID, ACCPT_ROLE, PYEE_ROLE) VALUES ('"+billNo+"', "+ecdsHistId+", '1', '8726.00', '2016-08-10', '2016-12-26', 'EM00', null, 'RC01', '测试01', '63618789-4', '1', '3', '305100001008', null, null, null, '中国民生银行北京分行', '0', '305100001008', null, '80197796-2', 'YTS005', '2', '305100001008', null, 'RC00', 'RC01')");
		        }
		        rs.close();
		        stment.close();
		        call(discXML, "UTF-8");
		        Thread.sleep(12000);
		        String discBillId=sequenceService.getPrimaryKeyValue();
		        ResultSet rs1= session.getResultSet("SELECT REQ_DRAFT_ID FROM TRGCT_BILL_INFO where id='"+rgctId+"'");
		        if(rs1.next()){	       
		        	String reqMsgId=rs1.getString("REQ_DRAFT_ID");
		        	String upDiscbillSql="UPDATE TDISC_BILL_INFO set OPER_STATUS='BS031',disc_id=?,cust_account='2',saler_interest='232.69',delay_days='3',gale_date='2016-12-26',interest_days='32',pay_money='8493.31',local_pay_money='8493.31',branch_no='0100',apply_oper_no='010001',audit_oper_no='010001',apply_commit_date='2016-11-24',apply_commit_time='2016-11-24 09:43:10',audit_commit_date='2016-11-24',audit_commit_time='2016-11-24 09:43:41',delay_type='0',last_bill_no='00012003' WHERE rgct_id=?";
		        	session.execute(upDiscbillSql,discApplyId,rgctId);
		        }
		        session.closeResultSetAndStatement(rs1);
		        }
		        ecdsCon.close();
		        return mv;
		    }
			
			
			/*
			 * 电票转入生成系统内的记账的票据
			 * 
			 */
			@RequestMapping(params="method=rebuyEleGernateBill")
		    public ModelAndView rebuyEleGernateBill(int count)throws Exception{
		        ModelAndView mv = new ModelAndView();
		        mv.setViewName("system/xml/xml");
		        ISequenceService sequenceService=ServiceFactory.getSequenceService();
		        IDB session = DBFactory.getDB();
		        Connection ecdsCon=getEcdsConnection();
		        String workDt=DateTimeUtil.getEcds_YYYY_MM_DD_Date().toString();
		        String rebuyApplyId=sequenceService.getPrimaryKeyValue();
		        String rebuyBatchNo="ZR0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
		        String rebuyApplySql="INSERT INTO TREBUY_APPLY_INFO (REBUY_ID, BATCH_NO, PROD_NO, BILL_TYPE, BILL_CLASS, REBUY_DT, RESALE_DUE_DT, RATE, RATE_TYPE, DELAY_TYPE, IS_DUMMY, IS_INNER, BIDECT_DUE_DT, DELAY_DAYS, IS_BIDIR_SALE, CUST_MANAGER_NAME, DEPT_NO, CREATE_DT, CREATE_TIME, DEPT_NAME, PROF_OWNER_NO, PROF_OWNER, CUST_NAME, DISC_TYPE, PRODUCT_ATTS, CB_RATE, FILE_NO, BILL_STORAGE_ORG, RESALE_STA_DT, SALEBACK_RATE, SALEBACK_MONEY, SALEBACK_RATE_TYPE, CUST_MANAGE, IS_ONLINE, BILL_STORAGE_ORG_NAME, IS_REDISC_CENTER, BUSI_BRANCH_NO, BUSI_BRANCH_NAME, ENDORSES_BANK_NO, BUSI_BRCH_BANK_NO, CUST_NO, CUST_TYPE, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, REMARK, CUST_ACCOUNT, CUST_BRANCH_NO, CUST_BRANCH_NAME, CUST_BANK_NO, CUST_BANK_NAME, TRADE_ACCT, TRADE_ACCT_NAME, SALE_ID, PROD_ATTR, BRANCH_NO, TRADE_ACCT_TYPE, TRADE_ACCT_ORG, CUST_ORG_CODE, ORDER_ID, APPLY_STATUS) VALUES (?, ?, '001002002', '1', '2', '2016-11-25', ' ', 3.000000, '360', ' ', '1', '1', ' ', ' ', ' ', '客户经理2', ' ', '2016-11-25', ' ', '客户部测试', ' ', ' ', ' ', '0', ' ', 0.000000, ' ', '0100', ' ', 0.000000, 0.00, ' ', '2', '0', '中国民生银行北京分行', '0', '0100', '中国民生银行北京分行', ' ', '305100001008', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '305100001008', '中国民生银行北京分行', '2', 'YTS005', ' ', ' ', '0100', ' ', ' ', ' ', ' ', ' ')";
		        session.execute(rebuyApplySql, rebuyApplyId,rebuyBatchNo);
		        for(int i=0;i<count;i++){
		        String billNo="13051000010082016111"+sequenceService.getPrimaryKeyValue();
		        String acptBillId=sequenceService.getPrimaryKeyValue();
		        String acptBatchId=sequenceService.getPrimaryKeyValue();
		        //String reqMsgId=sequenceService.getPrimaryKeyValue();
		        String rgctId=sequenceService.getPrimaryKeyValue();
		        String curHistId=sequenceService.getPrimaryKeyValue();
		        
		        String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES (?, ?, '', ' ', '', '30512016130510000100820160810100003584', '2', '1', ?, '2016-08-10', '1', '测试01', '2200008660', '3', '1', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', '305100001008', ' ', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', ' ', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', 8726.00, '2016-12-26', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '150405', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', 'RC01', '63618789-4', '80197796-2', '98988907-4', 'C_02', ' ', ' ', ' ')";
		        String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'C_02', 'C_08', ' ', ' ', '测试01', '2200008660', '3', '305100001008', ' ', '2', 'YTS005', '2200006456', '2', '305100001008', ' ', '2016-11-22', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '1', '1', '2200006456', 'YTS005', '2', '305100001008', 'YTS005', ' ', '305100001008', '2', ' ', ' ', '2016-11-22', ' ', ' ', '0', ' ', ' ', '提示收票回复', '1600009779', '1600009779', ' ', ' ', '1', '1600009783', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, '63618789-4', '98988907-4', 'RC01', 'RC01', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '1600009786', ' ', ' ', '2016-11-22', 'C_02')";
		        //银票
		        String acptBillSql="INSERT INTO TACPT_BILL_INFO (ACPTMX_ID, ACPT_ID, RGCT_ID, ESNO, BRANCH_NO, PROTOCAL_NO, FAC_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BRANCH_NO, REMITTER_BANK_NO, REMITTER_BANK_NAME, BILL_CLASS, BILL_TYPE, VOUCHER_TYPE, BILL_NO, BILL_MONEY, CURRENCY_CATEGORY, BILL_STATUS, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, PAYEE, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, DUE_DT, ISSUE_DT, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, COLLTN_STATUS, COLLTN_ID, SSPD_STATUS, SSPD_ID, PRINT_STATUS, PRSNTTN_ACCT_NO, PRSNTTN_NAME, PRSNTTN_BANK_NO, PRSNTTN_BANK_NAME, PAYMENT_PATH, PAYMENT_DT, CUST_REMARK, BANK_REMARK, PAY_WAIT_ORDER, TXL_CTRCT_NB, INVC_NB, REAL_ACCT_DT, REAL_ACCT_TIME, DRWG_BCK_OPER_NO, DRWG_BCK_DT, DRWG_BCK_TIME, DRWG_BCK_FLOW_NO, STATUS, APPLY_CANCEL_FLAG, REQUEST_MSG_ID, YZ_SOURCE, CONFER_NO, ACPT_DT) VALUES (?, ?, ?, 0, '0100', ' ', ' ', '测试01', '2200008660', '3', '0100', '305100001008', '中国民生银行北京分行营业部', '2', '1', '090', ?, 8726.00, 'RMB', '1', '305100001008', '中国民生银行北京分行', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '2016-12-26', '2016-08-10', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-12-26', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'BS436', ' ', '3051000010082016112200062725', ' ', ' ', '20161122')";
		        String batchNo="YC0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
		        String acptApplySql="INSERT INTO TACPT_APPLY_INFO (ACPT_ID, BATCH_NO, BRANCH_NO, PROTOCAL_NO, FAC_NO, FKJJH, PROD_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BANK_NO, REMITTER_BANK_NAME, ISSUE_BRANCH_NO, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, ISSUE_DT, DUE_DT, BILL_CLASS, BILL_TYPE, TOTAL_COUNT, TOTAL_AMT, TOTAL_AMT_FOR_DEDUCT, TOTAL_GRANT_AMT, FREEZE_TOTAL_GRANT_AMT, ACCOUNT_NO1, ACCOUNT_NAME1, ACCOUNT_BRANCH_NO1, ACCOUNT_BRANCH_NAME1, GRANT_AMT1, ACCOUNT_TYPE1, GRANT_NO1, FREEZE_GRANT_AMT1, ACCOUNT_NO2, ACCOUNT_NAME2, ACCOUNT_BRANCH_NO2, ACCOUNT_BRANCH_NAME2, GRANT_AMT2, ACCOUNT_TYPE2, GRANT_NO2, FREEZE_GRANT_AMT2, ACCOUNT_NO3, ACCOUNT_NAME3, ACCOUNT_BRANCH_NO3, ACCOUNT_BRANCH_NAME3, GRANT_AMT3, ACCOUNT_TYPE3, GRANT_NO3, FREEZE_GRANT_AMT3, ACCOUNT_NO4, ACCOUNT_NAME4, ACCOUNT_BRANCH_NO4, ACCOUNT_BRANCH_NAME4, GRANT_AMT4, ACCOUNT_TYPE4, GRANT_NO4, FREEZE_GRANT_AMT4, ACCOUNT_NO5, ACCOUNT_NAME5, ACCOUNT_BRANCH_NO5, ACCOUNT_BRANCH_NAME5, GRANT_AMT5, ACCOUNT_TYPE5, GRANT_NO5, FREEZE_GRANT_AMT5, BUSI_DIVISION, DEPT_NO, CUST_MANAGER, AUDIT_CHANNEL, LOAN_SYSTEM, BATCH_STATUS, DEDUCT_AMT, LOAN_AMT, LOAN_DT, LOAN_TIME, LOAN_START_DT, ORDER_ID, PROCESS_OPER_NO, PROCESS_DT, PROCESS_TIME, AUDIT_OPER_NO, AUDIT_DT, AUDIT_TIME, ACCT_OPER_NO, ACCOUNT_DT, ACCOUNT_TIME, ACCT_FLOW_NO, DEDUCT_OPER_NO, DEDUCT_DT, DEDUCT_TIME, OPER_NO, OPER_DT, OPER_TIME, GRANT_RATIO, LOAN_NO, PLEDGE_NO, SUSPD_BRANCH_NAME, SUSPD_BRANCH_NO, YZ_SOURCE, UPDATE_DT, UPDATE_TIME, ACCT_ORDER_ID1, ACCT_ORDER_ID2, ACCT_ORDER_ID3, ACCT_ORDER_ID4, ACCT_ORDER_ID5, REFUND_ORDER_ID, REFUND_FLAG, CONFER_NO) VALUES (?, ?, '0100', ' ', ' ', ' ', '030401020000000000', '测试01', '2200008660', '3', '305100001008', '中国民生银行北京分行营业部', '0100', '305100001008', '中国民生银行北京分行', '北京金融街道1号', '2016-08-10', '2016-12-26', '2', '1', 1, 8726.00, 8726.00, 0.00, 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', '1', ' ', ' ', ' ', ' ', ' ', ' ', '010001', ' ', '20161122152538', ' ', ' ', ' ', '010001', '2016-11-22', '20161122152845', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
		        String discXML="<?xml version=\"1.0\" encoding=\"UTF-8\"?><Document><functionId>106101</functionId><exSerial>122</exSerial><bankNo>" +
		        		"</bankNo><branchNo></branchNo><channel></channel><operator></operator><authOper></authOper><authPwd></authPwd>" +
		        		"<applyDate>"+workDt+"</applyDate><applyTime></applyTime><reserve></reserve><reserve1></reserve1><billList><bean>" +
		        		"<discType>0</discType><discRate>0.3</discRate><discMoney>1093.4</discMoney><settlementMark>0</settlementMark><inAcctNo>2</inAcctNo>" +
		        		"<inBankNo>305100001008</inBankNo><applicantAcctNo>2</applicantAcctNo><discDt>"+workDt+"</discDt><signature>1</signature>" +
		        		"<rgctId>"+rgctId+"</rgctId><banEndorsementMark>0</banEndorsementMark><receiverAcctNo>0</receiverAcctNo><receiverBankNo>305100001008" +
		        		"</receiverBankNo><receiverName>中国民生银行北京分行营业部</receiverName><batchNo>1</batchNo><conferNo>1</conferNo><invoiceNo>1</invoiceNo>" +
		        		"<remark>1</remark></bean></billList></Document>";
		        session.execute(rcBillSql, rgctId,curHistId,billNo);
		        session.execute(rcHistSql, curHistId,rgctId);
		        session.execute(acptApplySql, acptBatchId,batchNo);
		        session.execute(acptBillSql, acptBillId,acptBatchId,rgctId,billNo);
		        String ecdsHistSQL="INSERT INTO ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) VALUES (default, 2535, '030006', '测试01', 'RC01', '63618789-4', '305100001008', '3', null, '2', null, 'YTS005', 'RC01', '98988907-4', '305100001008', '2', null, '1', null, '3051000010082016112200062728', '2016-11-22', '031', '2016-11-22', null, null, '"+billNo+"', 'SU00', '3051000010082016112200062729', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 'PS01', null, null, null, null, null, null, null)";
		        Statement stment=ecdsCon.createStatement();
		        stment.execute(ecdsHistSQL);
		        ResultSet rs=stment.executeQuery("SELECT ID FROM ECDS_BILL_HIST where idnb='"+billNo+"'");
		        if(rs.next()){
		            Long ecdsHistId=rs.getLong("ID");
		            stment.execute("INSERT INTO ECDS_BILL_INFO (IDNB, HIST_ID, COMRCLDRFT_TP, CMRCLDRFT_ISSEAMT, COMRCLDRFT_ISSEDT, COMRCLDRFT_DUEDT, COMRCLDRFT_BANENDRSMTMK, COMRCLDRFT_RMRK, DRWR_ROLE, DRWR_NM, DRWR_CMONID, DRWR_ELCTRNCSGNTR, DRWR_ACCTID, DRWR_ACCTACCTSVCR, DRWR_CDTRATGS, DRWR_CDTRATGAGCY, DRWR_CDTRATGDUEDT, ACCPTR_NM, ACCPTR_ACCTID, ACCPTR_ACCTSVCR, ACCPTR_AGCY_ACCTSVCR, ACCPTR_CMONID, PYEE_NM, PYEE_ACCTID, PYEE_ACCTSVCR, PYEE_CMONID, ACCPT_ROLE, PYEE_ROLE) VALUES ('"+billNo+"', "+ecdsHistId+", '1', '8726.00', '2016-08-10', '2016-12-26', 'EM00', null, 'RC01', '测试01', '63618789-4', '1', '3', '305100001008', null, null, null, '中国民生银行北京分行', '0', '305100001008', null, '80197796-2', 'YTS005', '2', '305100001008', null, 'RC00', 'RC01')");
		        }
		        rs.close();
		        stment.close();
		        call(discXML, "UTF-8");
		        Thread.sleep(12000);
		        String discBillId=sequenceService.getPrimaryKeyValue();
		        String discApplyId=sequenceService.getPrimaryKeyValue();
		        ResultSet rs1= session.getResultSet("SELECT REQ_DRAFT_ID FROM TRGCT_BILL_INFO where id='"+rgctId+"'");
		        String discBatchNo="TX0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
		        String discApplySql="INSERT INTO TDISC_APPLY_INFO (DISC_ID, BATCH_NO, RATE, BUY_PAY_RATE, CUST_ACCOUNT, BRANCH_NO, PAY_TYPE, PAY_BANK_NO, PAY_CUST_NAME, PAY_ACCOUNT, PROD_NO, RATE_TYPE, BILL_TYPE, BILL_CLASS, DISC_DT, CUST_MANAGER_NAME, IS_TC, AGENT_CUST_NAME, AGENT_CUST_ACCOUNT, DELAY_TYPE, REDEMPTION_DT, DEPT_NO, CREATE_TIME, DEPT_NAME, REDEEM_DATE, CUST_NAME, TRUSTEE_NAME, TRUSTEE_ACCT, TRUSTEE_BANK_NAME, TRUSTEE_BANK_NO, PROF_OWNER_NO, PROF_OWNER, BILL_OWNER, WORKINGADS_NO1, CB_RATE, BANK_PROD_NO, WORKINGADS_NO, SIGN_BRANCH_NO, CUST_MANAGE, CUST_NO, PAY_ACCOUNT_TYPE, ORDER_ID, CUST_ACCOUNT_TYPE, ACCT_BRANCH_NO, PROD_BUSI_TYPE, CREATE_DT, APPLY_STATUS, PROFESSION_NAME, ENTERPRISE_SCALE, IS_RURAL_ENTERPRISES, SOCIAL_CREDIT_CODE) VALUES (?, ?, 30.000000, 0.000000, '2', '0100', '2', ' ', ' ', ' ', '001001003', '360', '1', '2', '2016-11-24', '客户经理2', ' ', ' ', ' ', ' ', ' ', ' ', '20161124094234', '客户部测试', ' ', 'YTS005', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 3.000000, ' ', ' ', ' ', '2', '2200006456', '7', ' ', '7', ' ', ' ', '2016-11-24', '2', '农、林、渔、牧业', null, null, null)";
		        String delDiscbillSql="delete from tdisc_bill_info where OPER_STATUS='BS011' and rgct_id=?";
		        session.execute(discApplySql,discApplyId,discBatchNo);
		        session.execute(delDiscbillSql,rgctId);
		        if(rs1.next()){	       
		        	String reqMsgId=rs1.getString("REQ_DRAFT_ID");
		        	String upDiscbillSql="INSERT INTO TDISC_BILL_INFO (DISCMX_ID, BILL_TYPE, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_BRANCH_NO, BILL_MONEY, DRAWEE_ADDR, PAYEE_BANK_NO, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, DISC_ID, RGCT_ID, CUST_NO, CUST_ACCOUNT, SALER_INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, BUYER_INTEREST, PAY_MONEY, IS_SAME_CITY, REMARK, IS_AUDITED, CONFER_NO, IS_ACCPT, LIMIT_PROD_NO, RATE, RATE_TYPE, DISC_DT, DISC_TYPE, FILE_NO, NO_LOU_LOANS, IS_ONLINE, REDEEM_END_DATE, PROFESSION_ID, BANK_PROD_NO, LOCAL_PAY_MONEY, IS_AMOUNT, FORBID_FLAG, IS_THIRD_AMOUNT, OUT_APPLY_NO, BRANCH_NO, OPER_BANK_NO, YZ_SOURCE, PRODUCT_ID, OWNER_PARTY_ID, IS_CYC, IS_CANCEL, REDEEM_OPEN_DT, DISC_SQUARE_ID, IN_ACCT_NO, IN_BANK_NO, EX_SERIAL, UPDATE_DT, UPDATE_TIME, ACCOUNT_DATE, ACCOUNT_TIME, COLL_DT, BILL_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, GATH_MNEY_TYPE, GATH_MNEY_DATE, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, AUDIT_COMMIT_DATE, AUDIT_COMMIT_TIME, ACCT_COMMIT_DATE, ACCT_COMMIT_TIME, TOTAL_INTRST_PAYMENT, DELAY_TYPE, ORG_CODE, QUERY_RESULT, QUERY_CONTENT, RETURN_CONTENT, REQ_MSG_ID, IN_STORE_DT, IN_STORE_TIME, INVOICE_NO, DRAFT_PAY_MONEY, COLL_ACCOUNT_DT, PROTOCAL_NO, CHANGE_DT, CHANGE_TIME, LAST_BILL_NO, CUR_STATUS, TRANS_ID, BUYBACK_ID, TRANS_TYPE, IS_REDEEM, LIMIT_REDUCE_ROW, OWNER_PARTY_NAME, AUDIT_REASON) VALUES (?, '1', '2016-08-10', '2016-12-26', '测试01', '3', '中国民生银行北京分行营业部', '305100001008', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', 8726.00, '北京金融街道1号', '305100001008', 'YTS005', '中国民生银行北京分行营业部', '2', ' ', 'YTS005', '2', '3', 'BS036', ?, ?, '2200006456', '2', 225.42, 3, '2016-12-26', 31, 0.00, 8500.58, '1', ' ', ' ', ' ', '1', ' ', 30.000000, '360', '2016-11-25', '0', ' ', ' ', '0', ' ', null, ' ', 8500.58, ' ', '0', ' ', ' ', '0100', '305100001008', '0', ' ', ' ', ' ', '0', ' ', ' ', '2', '305100001008', ' ', ' ', ' ', '2016-11-25', '2016-11-25 10:22:56', ' ', ?, '010001', '010001', '010001', '1', ' ', '2016-11-25', '2016-11-25 10:20:56', '2016-11-25', '2016-11-25 10:21:23', ' ', ' ', 0.00, '0', '98988907-4', ' ', ' ', ' ', ?, ' ', ' ', ' ', 1093.40, ' ', ' ', ' ', ' ', '00013712', '1', ' ', ' ', '1', ' ', ' ', ' ', ' ')";
		        	session.execute(upDiscbillSql,discBillId,discApplyId,rgctId,billNo,reqMsgId);
		        }
		        session.closeResultSetAndStatement(rs1);
		        Statement stment1=ecdsCon.createStatement();
		        String ecdsHistSql="INSERT INTO ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) VALUES (default, 3027, '110106', 'YTS005', 'RC01', '98988907-4', '305100001008', '2', null, '1', null, '中国民生银行北京分行营业部', 'RC00', '80197796-2', '305100001008', '0', null, '0', 'RM00', '3051000010082016112500063112', '2016-11-25', '031', '2016-11-25', null, 'EM00', '"+billNo+"', 'SU00', '3051000010082016112500063113', 'SM01', null, null, null, '0.300000', '1093.40', null, null, null, null, null, null, null, '2', '305100001008', 'PS01', null, null, null, null, null, null, null),(default, 3028, '130101', '中国民生银行北京分行', 'RC00', '80197796-2', '305100001008', '0', null, '中国民生银行北京分行', null, '中国民生银行北京分行', null, null, '305100001008', '0', null, null, 'RM00', '3051000010082016112500063115', '2016-11-25', '013', null, null, 'EM00', '"+billNo+"', null, null, 'SM01', null, null, null, '0.0', '8726.00', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)";
		        stment1.execute(ecdsHistSql);
		        stment1.close();
		        String histId1=sequenceService.getPrimaryKeyValue();
		        String histId2=sequenceService.getPrimaryKeyValue();
		        String rcBillInfoSql="update trgct_bill_info set bill_source='1',cur_status='I_11',hist_id=? where id=?";
		        session.execute(rcBillInfoSql,histId2,rgctId);
		        String rcBillHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'F_02', 'F_08', ' ', ?, 'YTS005', '2200006456', '2', '305100001008', ' ', '1', '中国民生银行北京分行营业部', '2200006456', '0', '305100001008', ' ', '2016-11-25', ' ', 0.300000, 0.00, 1093.40, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', '1', '2200006456', '中国民生银行北京分行营业部', '0', '305100001008', '中国民生银行北京分行营业部', ' ', '305100001008', '0', ' ', ' ', '2016-11-25', ' ', ' ', '1', ' ', ' ', '买断式贴现回复', '1600013722', '1600013722', '0', ' ', '1', '1600013725', ' ', ' ', ' ', ' ', ' ', ' ', '2', '305100001008', ' ', ' ', '0', ' ', ' ', ' ', 0.300000, '2016-11-25', '3', ' ', '1', ' ', '2016-12-26', 31, 0.00, '98988907-4', '80197796-2', 'RC01', 'RC00', 'YTS005', ' ', ' ', ' ', '1', ' ', ' ', ' ', '1600013730', ' ', ' ', '2016-11-25', 'F_02'),(?, ?, 'I_11', 'F_02', ' ', ?, '中国民生银行北京分行', '2200006456', '0', '305100001008', ' ', '1', '中国民生银行北京分行', '2200006456', '0', '305100001008', ' ', '2016-11-25', ' ', 0.000000, 0.00, 8726.00, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', '1', '2200006456', '中国民生银行北京分行营业部', '0', '305100001008', '中国民生银行北京分行营业部', ' ', '305100001008', '0', ' ', ' ', '2016-11-25', ' ', ' ', '0', ' ', ' ', '买断式转贴现', '1600013730', '1600013730', '0', ' ', '1', '1600013746', ' ', ' ', '0', ' ', ' ', ' ', '2', '305100001008', ' ', ' ', '0', ' ', ' ', ' ', 0.300000, '2016-11-25', '3', ' ', '1', ' ', '2016-12-26', 31, 0.00, '80197796-2', '80197796-2', 'RC00', 'RC00', 'YTS005', ' ', ' ', ' ', '1', ' ', ' ', ' ', '1600013730', ' ', ' ', '2016-11-25', 'F_02')";
		        session.execute(rcBillHistSql,histId1,rgctId,discBatchNo,histId2,rgctId,discBatchNo);
		        String salebillId=sequenceService.getPrimaryKeyValue();
		        String salebillSql="INSERT INTO TSALE_BILL_INFO (SALEMX_ID, BILL_TYPE, BILL_NO, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_CUST_NO, REMITTER_BANK_NAME, REMITTER_BANK_NO, BILL_MONEY, ACCEPTOR, PAYEE_NAME, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, SALE_ID, RGCT_ID, BRANCH_NO, CUST_ACCOUNT, IS_SAME_CITY, INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, RECEIVE_MONEY, REMARK, CREATE_DATE, CREATE_TIME, DRAWEE_ADDR, PAYEE_BANK_NO, IS_ACCPT, RATE, RATE_TYPE, BUY_DEPT_NO, SALE_PRACT_ID, BUYBACK_MONEY, IS_ONLINE, FORBID_FLAG, BILL_SOURCE_ID, IS_DELAY_IN, EX_SERIAL, IS_BUYBACK, SALE_SQUARE_ID, YZ_SOURCE, BIDIR_SALE_HIST_FLAG, PAY_TRADE_NO, BUY_MONEY, PRIOR_SRC, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, APPLY_TELLER_DT, APPLY_TELLER_TIME, AUDIT_TELLER_DT, AUDIT_TELLER_TIME, ACCT_TELLER_DT, ACCT_TELLER_TIME, GATH_MNEY_DATE, ACCOUNT_DATE, CUST_MANAGE, CUST_MANAGE_DEPT_NO, WORK_BRANCH_NO, COST_RATE, DELAY_TYPE, BILL_STORAGE_ORG, IS_INNER, RESALE_DUE_DT, INTEREST_BUYBACK, PAYMONEY_BUYBACK, PRIOR_SRC_ID, BUY_TYPE, CUST_MANAGE_NAME, CUST_MANAGE_DEPT_NAME, WORK_BRANCH_NAME, RESALE_OPEN_DT, OLD_RATE, OLD_GALE_DATE, BATCH_ID, OLD_INTEREST, OLD_INST_CAL_DAYS, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, OLD_DISC_DT, OLD_FILE_NO, CUR_STATUS, IF_RECOURS_AVIOD, AUDIT_REASON) VALUES (?, '1', ?, '2016-08-10', '2016-12-26', '测试01', '3', '2200008660', '中国民生银行北京分行营业部', '305100001008', 8726.00, '中国民生银行北京分行', 'YTS005', '中国民生银行北京分行营业部', '2', 'YTS005', 'YTS005', '2', '1', 'BS224', '1600013736', ?, '00010100', ' ', '1', 0.00, 3, '2016-12-26', 31, 8726.00, ' ', '2016-11-25', '10:24:49', '北京金融街道1号', '305100001008', '1', 0.000000, '360', ' ', ' ', 0.000000, '0', '0', ' ', '0', ' ', '0', ' ', '0', '0', ' ', 1093.40, '1', '010001', '010001', ' ', '2016-11-25', '10:25:00', ' ', '2016-11-25', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, '0', ' ', '1', ' ', 0.00, 0.00, ?, '1', ' ', ' ', ' ', ' ', 30.000000, '2016-12-26', ' ', 225.42, 31, '305100001008', '中国民生银行北京分行', '2016-11-25', ' ', ' ', ' ', ' ')";
		        session.execute(salebillSql,salebillId,billNo,rgctId,discBillId);
		        String rebuyBillId=sequenceService.getPrimaryKeyValue();
		        String rebuyBillSql="INSERT INTO TREBUY_BILL_INFO (REBUYMX_ID, BILL_TYPE, BILL_NO, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, BILL_MONEY, ACCEPTOR, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, REBUY_ID, RGCT_ID, CUST_ACCOUNT, IS_SAME_CITY, INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, PAY_MONEY, REMARK, CREATE_DATE, CREATE_TIME, IS_AUDITED, DRAWEE_ADDR, PAYEE_BANK_NO, CONFER_NO, IS_ACCPT, IS_INNER, LIMIT_BILL_ID, LIMIT_PROD_NO, RATE, RATE_TYPE, REMITTER_CUST_NO, CHANNEL, IS_DELAY_IN, SALE_ID, IS_ONLINE, FORBID_FLAG, REBUY_DT, RESALE_STA_DT, RESALE_DUE_DT, LIMIT_TYPE, LIMIT_NO, BILL_STORAGE_ORG, YZ_SOURCE, PROD_NO, OWNER_PARTY_ID, IS_CYC, PRODUCT_NAME, OWNER_PARTY_NAME, IS_CYC_NAME, EX_SERIAL, IS_BUYBACK, REBUY_SQUARE_ID, IS_REDISC_CENTER, PAY_TRADE_NO, BEGIN_DATE, CHECK_INTEREST, CUST_NO, CUST_BANK_NO, CUST_BANK_NAME, DELAY_TYPE, IS_REGRESS, FAC_MSG, IS_AMOUNT, ENDORSES_BANK_NO, FAC_OPER_TYPE, COLL_DATE, ACCOUNT_DATE, ACCOUNT_TIME, TOTAL_INTRST_PAYMENT, GATH_DATE, GATH_TYPE, ENDORSES_BANK_NAME, SALEMX_ID, CHECK_PAY_MONEY, ADJUST_FLAG, INTEREST_SALEBACK1, PAYMONEY_SALEBACK1, APPLY_CANCEL_FLAG, REQ_DRAFT_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, CUST_ORG_CODE, POSITION, CUST_TYPE, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, CUR_STATUS, TRANS_ID, TRANS_TYPE, BUYBACK_ID, IS_ELEC_DEPOSIT, ZC_SOURCE, ZC_SOURCE_ID, LIMIT_REDUCE_ROW, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, BRANCH_NO, OPER_BANK_NO, AUDIT_REASON) VALUES (?, '1', ?, '2016-08-10', '2016-12-26', '测试01', '3', '中国民生银行北京分行营业部', '305100001008', 8726.00, '中国民生银行北京分行', 'YTS005', '中国民生银行北京分行营业部', '2', ' ', '中国民生银行北京分行', '2', ' ', 'BS131', ?, ?, '0', '1', 0.00, 3, '2016-12-26', 31, 8726.00, ' ', '2016-11-25', '20161125102954', ' ', ' ', '305100001008', ' ', '1', '1', ' ', ' ', 0.000000, '360', ' ', ' ', ' ', '1600013736', '0', '0', '2016-11-25', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '0', ' ', '0', ' ', ' ', 0.00, '2200006456', '305100001008', '中国民生银行北京分行', '0', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', '1600013742', 8726.00, ' ', 0.00, 0.00, '0', '3051000010082016112500063115', '010001', '010001', ' ', '80197796-2', ' ', ' ', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', '1', ' ', ' ', '20161125', '2016-11-25', '0100', ' ', ' ')";
		        session.execute(rebuyBillSql,rebuyBillId,billNo,rebuyApplyId,rgctId);
		        String balanceId=sequenceService.getPrimaryKeyValue();
		        String acctBalaSql="INSERT INTO TACCT_BALANCE (BALANCE_ID, INFO_ID, RGCT_ID, BILL_NO, START_DT, END_DT, CUST_NO, CUST_NAME, PROD_NO, STATUS, CREATE_DT, CREATE_TM, UPDATE_DT, UPDATE_TM, STORAGE_BRCH_NO, STORAGE_BRCH_NAME, ACCT_BRCH_NO, ACCT_BRCH_NAME) VALUES (?, ?, '1600013715', ?, '2016-11-25', ' ', '2200006456', 'YTS005', '001001003', '1', '161125', '10:22:56', ' ', ' ', ' ', ' ', ' ', ' ')";
		        session.execute(acctBalaSql,balanceId,discBillId,rgctId);
		        String endoId=sequenceService.getPrimaryKeyValue();
		        String endoHistSql="INSERT INTO TRGCT_ENDO_HIST (ID, RGCT_ID, ENDO_TYPE, FROM_NAME, FROM_ACCT_NO, FROM_BANK_NO, FROM_ORG_CODE, TO_NAME, TO_ACCT_NO, TO_BANK_NO, TO_ORG_CODE, ENDORSE_DT, ENDORSE_TIME, SIGN_DATE, SIGN_TIME, RPD_OPEN_DATE, RPD_DUE_DATE, FORBID_FLAG, IS_REJECT_PRSNT, REJECT_PRSNT_RSN, RECOURSE_TYPE, GUARNTEE_ADR, REMARK, CREATE_TIME, CREATE_DT) VALUES (?, ?, '1', 'YTS005', '2', '305100001008', '98988907-4', '中国民生银行北京分行营业部', '0', '305100001008', '80197796-2', '2016-11-25', ' ', ' ', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
		        session.execute(endoHistSql,endoId,rgctId);
		        }
		        ecdsCon.close();
		        return mv;
		    }
			
			
			/*
			 * 电票转卖生成转卖记账的票据
			 * 
			 */
			@RequestMapping(params="method=saleEleGernateBill")
		    public ModelAndView saleEleGernateBill(int count)throws Exception{
		        ModelAndView mv = new ModelAndView();
		        mv.setViewName("system/xml/xml");
		        ISequenceService sequenceService=ServiceFactory.getSequenceService();
		        IDB session = DBFactory.getDB();
		        Connection ecdsCon=getEcdsConnection();
		        String workDt=DateTimeUtil.getEcds_YYYY_MM_DD_Date().toString();
		        String saleApplyId=sequenceService.getPrimaryKeyValue();
		        String saleBatchNo="ZC0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
		        String saleApplySql="INSERT INTO TSALE_APPLY_INFO (SALE_ID, BATCH_NO, AIM_BRANCH_NO, PROD_NO, BILL_TYPE, BILL_CLASS, INNER_ACCOUNT, SALE_DT, SALE_TIME, REBUY_DUE_DT, RATE, RATE_TYPE, DELAY_TYPE, IS_DUMMY, IS_INNER, BIDECT_DUE_DT, DELAY_DAYS, BRANCH_ID, IF_BIDIR_BUY, STATUS, CREATE_DT, CREATE_TIME, OPER_NO, BATCH_TYPE, IS_REDISC, SALE_TYPE, BUYBACK_RATE, BUYBACK_OPEN_DT, BUYBACK_MONEY, IS_ONLINE, MOCK_AIM_NAME, PROD_ATTR, CUST_NAME, FINANCIAL_CUST_NO, CUST_BANK_NAME, CUST_BANK_NO, FACT_BANK_NO, FACT_BANK_NAME, FORBID_FLAG, BRANCH_NO, CUST_TYPE, BILL_STORAGE_BRCHNO, BILL_STORAGE_NAME, BILL_STORAGE_BRCHID, CUST_NO, PROD_ATTR_NO, IN_ACCT_NO, IN_ACCT_TYPE, IN_ACCT_NAME, BILL_POSITION_BRANCH, CUST_MANAGE, CUST_MANAGER_NAME, DEPT_NO, DEPT_NAME, WORKINGADS_NO, WORKINGADS_NAME, ORDER_ID, APPLY_STATUS) VALUES (?, ?, '303100000006', '001003002', '1', '2', '0', '2016-11-25', ' ', ' ', 3.000000, '360', ' ', '0', '0', ' ', ' ', ' ', '0', ' ', '2016-11-25', '17:01:15', '010001', ' ', '0', '0', 0.000000, ' ', 0.00, '0', ' ', ' ', '中国光大银行', ' ', ' ', ' ', ' ', ' ', '0', ' ', '1', '0100', '中国民生银行北京分行', '00010100', ' ', ' ', '2', '1', 'YTS005', ' ', '2', '客户经理2', ' ', '客户部测试', ' ', ' ', ' ', '2')";
		        session.execute(saleApplySql, saleApplyId,saleBatchNo);
		        for(int i=0;i<count;i++){
		        String billNo="13051000010082016111"+sequenceService.getPrimaryKeyValue();
		        String acptBillId=sequenceService.getPrimaryKeyValue();
		        String acptBatchId=sequenceService.getPrimaryKeyValue();
		        String rgctId=sequenceService.getPrimaryKeyValue();
		        String curHistId=sequenceService.getPrimaryKeyValue();
		        
		        String rcBillSql="INSERT INTO TRGCT_BILL_INFO (ID, HIST_ID, REQ_DRAFT_ID, RESP_DRAFT_ID, TEMP_HIST_ID, EBS_NO, BILL_CLASS, BILL_TYPE, BILL_NO, ISSUE_DT, IS_ACCPT, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_SIGN, REMITTER_BANK_NO, REMITTER_BANK_NAME, DRAWEE_BANK_NAME, DRAWEE_BANK_NO, DRAWEE_BRANCH_NO, DRAWEE_ADDR, PAYEE_NAME, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, ACCEPTOR, ACCEPTOR_CUST_NO, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_SIGN, ASSURE_BANK_NAME, ASSURE_BANK_NO, LETTER_NO, ASSURE_SELF, BILL_SOURCE, BILL_MONEY, DUE_DT, CONFER_NO, INFO_FORBID_FLAG, DEDUCT_FLAG, IS_ACPT_ACCT, BILL_USAGE, REMARK, CANCEL_REASON, CANCEL_REMARK, CREATE_DT, CREATE_TIME, DEL_FLAG, INVOICE_NO, REMITTER_REMARK, DRAFT_INFO, DRWR_CREDITRATING, DRWR_CREDITRATING_AGENCY, DRWR_CREDITRATING_DUEDT, ACPTR_CREDITRATING, ACPTR_CREDITRATING_AGENCY, ACPTR_CREDITRATING_DUEDT, BUSI_DEEP, ACCEPTOR_DATE, RECOURSE_FLAG, REMITTER_ROLE, REMITTER_ORG_CODE, ACCEPTOR_ORG_CODE, PAYEE_ORG_CODE, CUR_STATUS, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, ACCEPTOR_ROLE) VALUES (?, ?, '', ' ', '', '30512016130510000100820160810100003584', '2', '1', ?, '2016-08-10', '1', '测试01', '2200008660', '3', '1', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', '305100001008', ' ', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '中国民生银行北京分行', ' ', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', 8726.00, '2016-12-26', ' ', '0', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '150405', '0', ' ', ' ', null, ' ', ' ', ' ', ' ', ' ', ' ', 0, ' ', ' ', 'RC01', '63618789-4', '80197796-2', '98988907-4', 'C_02', ' ', ' ', ' ')";
		        String rcHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES (?, ?, 'C_02', 'C_08', ' ', ' ', '测试01', '2200008660', '3', '305100001008', ' ', '2', 'YTS005', '2200006456', '2', '305100001008', ' ', '2016-11-22', ' ', 0.000000, 0.00, 0.00, ' ', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '1', '1', '2200006456', 'YTS005', '2', '305100001008', 'YTS005', ' ', '305100001008', '2', ' ', ' ', '2016-11-22', ' ', ' ', '0', ' ', ' ', '提示收票回复', '1600009779', '1600009779', ' ', ' ', '1', '1600009783', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.000000, ' ', ' ', ' ', ' ', ' ', ' ', 0, 0.00, '63618789-4', '98988907-4', 'RC01', 'RC01', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '1600009786', ' ', ' ', '2016-11-22', 'C_02')";
		        //银票
		        String acptBillSql="INSERT INTO TACPT_BILL_INFO (ACPTMX_ID, ACPT_ID, RGCT_ID, ESNO, BRANCH_NO, PROTOCAL_NO, FAC_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BRANCH_NO, REMITTER_BANK_NO, REMITTER_BANK_NAME, BILL_CLASS, BILL_TYPE, VOUCHER_TYPE, BILL_NO, BILL_MONEY, CURRENCY_CATEGORY, BILL_STATUS, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, PAYEE, PAYEE_ACCT, PAYEE_BANK_NO, PAYEE_BANK_NAME, DUE_DT, ISSUE_DT, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, COLLTN_STATUS, COLLTN_ID, SSPD_STATUS, SSPD_ID, PRINT_STATUS, PRSNTTN_ACCT_NO, PRSNTTN_NAME, PRSNTTN_BANK_NO, PRSNTTN_BANK_NAME, PAYMENT_PATH, PAYMENT_DT, CUST_REMARK, BANK_REMARK, PAY_WAIT_ORDER, TXL_CTRCT_NB, INVC_NB, REAL_ACCT_DT, REAL_ACCT_TIME, DRWG_BCK_OPER_NO, DRWG_BCK_DT, DRWG_BCK_TIME, DRWG_BCK_FLOW_NO, STATUS, APPLY_CANCEL_FLAG, REQUEST_MSG_ID, YZ_SOURCE, CONFER_NO, ACPT_DT) VALUES (?, ?, ?, 0, '0100', ' ', ' ', '测试01', '2200008660', '3', '0100', '305100001008', '中国民生银行北京分行营业部', '2', '1', '090', ?, 8726.00, 'RMB', '1', '305100001008', '中国民生银行北京分行', '北京金融街道1号', 'YTS005', '2', '305100001008', '中国民生银行北京分行营业部', '2016-12-26', '2016-08-10', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '2016-12-26', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 'BS436', ' ', '3051000010082016112200062725', ' ', ' ', '20161122')";
		        String batchNo="YC0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
		        String acptApplySql="INSERT INTO TACPT_APPLY_INFO (ACPT_ID, BATCH_NO, BRANCH_NO, PROTOCAL_NO, FAC_NO, FKJJH, PROD_NO, REMITTER, REMITTER_CUST_NO, REMITTER_ACCT, REMITTER_BANK_NO, REMITTER_BANK_NAME, ISSUE_BRANCH_NO, DRAWEE_BANK_NO, DRAWEE_BANK_NAME, DRAWEE_ADDR, ISSUE_DT, DUE_DT, BILL_CLASS, BILL_TYPE, TOTAL_COUNT, TOTAL_AMT, TOTAL_AMT_FOR_DEDUCT, TOTAL_GRANT_AMT, FREEZE_TOTAL_GRANT_AMT, ACCOUNT_NO1, ACCOUNT_NAME1, ACCOUNT_BRANCH_NO1, ACCOUNT_BRANCH_NAME1, GRANT_AMT1, ACCOUNT_TYPE1, GRANT_NO1, FREEZE_GRANT_AMT1, ACCOUNT_NO2, ACCOUNT_NAME2, ACCOUNT_BRANCH_NO2, ACCOUNT_BRANCH_NAME2, GRANT_AMT2, ACCOUNT_TYPE2, GRANT_NO2, FREEZE_GRANT_AMT2, ACCOUNT_NO3, ACCOUNT_NAME3, ACCOUNT_BRANCH_NO3, ACCOUNT_BRANCH_NAME3, GRANT_AMT3, ACCOUNT_TYPE3, GRANT_NO3, FREEZE_GRANT_AMT3, ACCOUNT_NO4, ACCOUNT_NAME4, ACCOUNT_BRANCH_NO4, ACCOUNT_BRANCH_NAME4, GRANT_AMT4, ACCOUNT_TYPE4, GRANT_NO4, FREEZE_GRANT_AMT4, ACCOUNT_NO5, ACCOUNT_NAME5, ACCOUNT_BRANCH_NO5, ACCOUNT_BRANCH_NAME5, GRANT_AMT5, ACCOUNT_TYPE5, GRANT_NO5, FREEZE_GRANT_AMT5, BUSI_DIVISION, DEPT_NO, CUST_MANAGER, AUDIT_CHANNEL, LOAN_SYSTEM, BATCH_STATUS, DEDUCT_AMT, LOAN_AMT, LOAN_DT, LOAN_TIME, LOAN_START_DT, ORDER_ID, PROCESS_OPER_NO, PROCESS_DT, PROCESS_TIME, AUDIT_OPER_NO, AUDIT_DT, AUDIT_TIME, ACCT_OPER_NO, ACCOUNT_DT, ACCOUNT_TIME, ACCT_FLOW_NO, DEDUCT_OPER_NO, DEDUCT_DT, DEDUCT_TIME, OPER_NO, OPER_DT, OPER_TIME, GRANT_RATIO, LOAN_NO, PLEDGE_NO, SUSPD_BRANCH_NAME, SUSPD_BRANCH_NO, YZ_SOURCE, UPDATE_DT, UPDATE_TIME, ACCT_ORDER_ID1, ACCT_ORDER_ID2, ACCT_ORDER_ID3, ACCT_ORDER_ID4, ACCT_ORDER_ID5, REFUND_ORDER_ID, REFUND_FLAG, CONFER_NO) VALUES (?, ?, '0100', ' ', ' ', ' ', '030401020000000000', '测试01', '2200008660', '3', '305100001008', '中国民生银行北京分行营业部', '0100', '305100001008', '中国民生银行北京分行', '北京金融街道1号', '2016-08-10', '2016-12-26', '2', '1', 1, 8726.00, 8726.00, 0.00, 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', 0.00, ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', '1', ' ', ' ', ' ', ' ', ' ', ' ', '010001', ' ', '20161122152538', ' ', ' ', ' ', '010001', '2016-11-22', '20161122152845', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 0.00, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ')";
		        String discXML="<?xml version=\"1.0\" encoding=\"UTF-8\"?><Document><functionId>106101</functionId><exSerial>122</exSerial><bankNo>" +
		        		"</bankNo><branchNo></branchNo><channel></channel><operator></operator><authOper></authOper><authPwd></authPwd>" +
		        		"<applyDate>"+workDt+"</applyDate><applyTime></applyTime><reserve></reserve><reserve1></reserve1><billList><bean>" +
		        		"<discType>0</discType><discRate>0.3</discRate><discMoney>1093.4</discMoney><settlementMark>0</settlementMark><inAcctNo>2</inAcctNo>" +
		        		"<inBankNo>305100001008</inBankNo><applicantAcctNo>2</applicantAcctNo><discDt>"+workDt+"</discDt><signature>1</signature>" +
		        		"<rgctId>"+rgctId+"</rgctId><banEndorsementMark>0</banEndorsementMark><receiverAcctNo>0</receiverAcctNo><receiverBankNo>305100001008" +
		        		"</receiverBankNo><receiverName>中国民生银行北京分行营业部</receiverName><batchNo>1</batchNo><conferNo>1</conferNo><invoiceNo>1</invoiceNo>" +
		        		"<remark>1</remark></bean></billList></Document>";
		        session.execute(rcBillSql, rgctId,curHistId,billNo);
		        session.execute(rcHistSql, curHistId,rgctId);
		        session.execute(acptApplySql, acptBatchId,batchNo);
		        session.execute(acptBillSql, acptBillId,acptBatchId,rgctId,billNo);
		        
		        String ecdsHistSQL="INSERT INTO ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) VALUES (default, 2535, '030006', '测试01', 'RC01', '63618789-4', '305100001008', '3', null, '2', null, 'YTS005', 'RC01', '98988907-4', '305100001008', '2', null, '1', null, '3051000010082016112200062728', '2016-11-22', '031', '2016-11-22', null, null, '"+billNo+"', 'SU00', '3051000010082016112200062729', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, 'PS01', null, null, null, null, null, null, null)";
		        Statement stment=ecdsCon.createStatement();
		        stment.execute(ecdsHistSQL);
		        ResultSet rs=stment.executeQuery("SELECT ID FROM ECDS_BILL_HIST where idnb='"+billNo+"'");
		        if(rs.next()){
		            Long ecdsHistId=rs.getLong("ID");
		            stment.execute("INSERT INTO ECDS_BILL_INFO (IDNB, HIST_ID, COMRCLDRFT_TP, CMRCLDRFT_ISSEAMT, COMRCLDRFT_ISSEDT, COMRCLDRFT_DUEDT, COMRCLDRFT_BANENDRSMTMK, COMRCLDRFT_RMRK, DRWR_ROLE, DRWR_NM, DRWR_CMONID, DRWR_ELCTRNCSGNTR, DRWR_ACCTID, DRWR_ACCTACCTSVCR, DRWR_CDTRATGS, DRWR_CDTRATGAGCY, DRWR_CDTRATGDUEDT, ACCPTR_NM, ACCPTR_ACCTID, ACCPTR_ACCTSVCR, ACCPTR_AGCY_ACCTSVCR, ACCPTR_CMONID, PYEE_NM, PYEE_ACCTID, PYEE_ACCTSVCR, PYEE_CMONID, ACCPT_ROLE, PYEE_ROLE) VALUES ('"+billNo+"', "+ecdsHistId+", '1', '8726.00', '2016-08-10', '2016-12-26', 'EM00', null, 'RC01', '测试01', '63618789-4', '1', '3', '305100001008', null, null, null, '中国民生银行北京分行', '0', '305100001008', null, '80197796-2', 'YTS005', '2', '305100001008', null, 'RC00', 'RC01')");
		        }
		        rs.close();
		        stment.close();
		        String discBillId=sequenceService.getPrimaryKeyValue();
		        String discApplyId=sequenceService.getPrimaryKeyValue();
		        ResultSet rs1= session.getResultSet("SELECT REQ_DRAFT_ID FROM TRGCT_BILL_INFO where id='"+rgctId+"'");
		        String discBatchNo="TX0100"+StringUtils.leftPad(System.currentTimeMillis()+"",14,"0");
		        String discApplySql="INSERT INTO TDISC_APPLY_INFO (DISC_ID, BATCH_NO, RATE, BUY_PAY_RATE, CUST_ACCOUNT, BRANCH_NO, PAY_TYPE, PAY_BANK_NO, PAY_CUST_NAME, PAY_ACCOUNT, PROD_NO, RATE_TYPE, BILL_TYPE, BILL_CLASS, DISC_DT, CUST_MANAGER_NAME, IS_TC, AGENT_CUST_NAME, AGENT_CUST_ACCOUNT, DELAY_TYPE, REDEMPTION_DT, DEPT_NO, CREATE_TIME, DEPT_NAME, REDEEM_DATE, CUST_NAME, TRUSTEE_NAME, TRUSTEE_ACCT, TRUSTEE_BANK_NAME, TRUSTEE_BANK_NO, PROF_OWNER_NO, PROF_OWNER, BILL_OWNER, WORKINGADS_NO1, CB_RATE, BANK_PROD_NO, WORKINGADS_NO, SIGN_BRANCH_NO, CUST_MANAGE, CUST_NO, PAY_ACCOUNT_TYPE, ORDER_ID, CUST_ACCOUNT_TYPE, ACCT_BRANCH_NO, PROD_BUSI_TYPE, CREATE_DT, APPLY_STATUS, PROFESSION_NAME, ENTERPRISE_SCALE, IS_RURAL_ENTERPRISES, SOCIAL_CREDIT_CODE) VALUES " +
		        		"(?, ?, 30.000000, 0.000000, '2', '0100', '2', ' ', ' ', ' ', '001001003', '360', '1', '2', '2016-11-24', '客户经理2', ' ', ' ', ' ', ' ', ' ', ' ', '20161124094234', '客户部测试', ' ', 'YTS005', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 3.000000, ' ', ' ', ' ', '2', '2200006456', '7', ' ', '7', ' ', ' ', '2016-11-24', '2', '农、林、渔、牧业', null, null, null)";
		        session.execute(discApplySql,discApplyId,discBatchNo);
		        if(rs1.next()){	       
		        	String reqMsgId=rs1.getString("REQ_DRAFT_ID");
		        	String upDiscbillSql="INSERT INTO TDISC_BILL_INFO (DISCMX_ID, BILL_TYPE, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_BANK_NAME, REMITTER_BANK_NO, ACCEPTOR, ACCEPTOR_ACCT, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, ACCEPTOR_BRANCH_NO, BILL_MONEY, DRAWEE_ADDR, PAYEE_BANK_NO, PAYEE, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, DISC_ID, RGCT_ID, CUST_NO, CUST_ACCOUNT, SALER_INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, BUYER_INTEREST, PAY_MONEY, IS_SAME_CITY, REMARK, IS_AUDITED, CONFER_NO, IS_ACCPT, LIMIT_PROD_NO, RATE, RATE_TYPE, DISC_DT, DISC_TYPE, FILE_NO, NO_LOU_LOANS, IS_ONLINE, REDEEM_END_DATE, PROFESSION_ID, BANK_PROD_NO, LOCAL_PAY_MONEY, IS_AMOUNT, FORBID_FLAG, IS_THIRD_AMOUNT, OUT_APPLY_NO, BRANCH_NO, OPER_BANK_NO, YZ_SOURCE, PRODUCT_ID, OWNER_PARTY_ID, IS_CYC, IS_CANCEL, REDEEM_OPEN_DT, DISC_SQUARE_ID, IN_ACCT_NO, IN_BANK_NO, EX_SERIAL, UPDATE_DT, UPDATE_TIME, ACCOUNT_DATE, ACCOUNT_TIME, COLL_DT, BILL_NO, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, GATH_MNEY_TYPE, GATH_MNEY_DATE, APPLY_COMMIT_DATE, APPLY_COMMIT_TIME, AUDIT_COMMIT_DATE, AUDIT_COMMIT_TIME, ACCT_COMMIT_DATE, ACCT_COMMIT_TIME, TOTAL_INTRST_PAYMENT, DELAY_TYPE, ORG_CODE, QUERY_RESULT, QUERY_CONTENT, RETURN_CONTENT, REQ_MSG_ID, IN_STORE_DT, IN_STORE_TIME, INVOICE_NO, DRAFT_PAY_MONEY, COLL_ACCOUNT_DT, PROTOCAL_NO, CHANGE_DT, CHANGE_TIME, LAST_BILL_NO, CUR_STATUS, TRANS_ID, BUYBACK_ID, TRANS_TYPE, IS_REDEEM, LIMIT_REDUCE_ROW, OWNER_PARTY_NAME, AUDIT_REASON) VALUES (?, '1', '2016-08-10', '2016-12-26', '测试01', '3', '中国民生银行北京分行营业部', '305100001008', '中国民生银行北京分行', '0', '305100001008', '中国民生银行北京分行', ' ', 8726.00, '北京金融街道1号', '305100001008', 'YTS005', '中国民生银行北京分行营业部', '2', ' ', 'YTS005', '2', '3', 'BS036', ?, ?, '2200006456', '2', 232.69, 3, '2016-12-26', 32, 0.00, 8493.31, '1', ' ', ' ', ' ', '1', ' ', 30.000000, '360', '2016-11-24', '0', ' ', ' ', '0', ' ', null, ' ', 8493.31, ' ', '0', ' ', ' ', '0100', '305100001008', '0', ' ', ' ', ' ', '0', ' ', ' ', '2', '305100001008', ' ', ' ', ' ', '2016-11-25', '2016-11-25 05:00:11', ' ', ?, '010001', '010001', '010001', '1', ' ', '2016-11-24', '2016-11-24 09:43:10', '2016-11-24', '2016-11-24 09:43:41', ' ', ' ', 0.00, '0', '98988907-4', ' ', ' ', ' ', ?, ' ', ' ', ' ', 1093.40, ' ', ' ', ' ', ' ', '00012003', '1', ' ', ' ', '1', ' ', ' ', ' ', ' ')";
		        	session.execute(upDiscbillSql,discBillId,discApplyId,rgctId,billNo,reqMsgId);
		        }
		        session.closeResultSetAndStatement(rs1);
		        Statement stment1=ecdsCon.createStatement();
		        String ecdsHistSql="INSERT INTO ECDS_BILL_HIST (ID, LAST_HIST_ID, CUR_STATUS, APPLICANT_NAME, APPLICANT_ROLE, APPLICANT_ORGCODE, APPLICANT_BANKNO, APPLICANT_ACCTNO, APPLICANT_REMARK, APPLICANT_SIGN, APPLICANT_PROXYSIGN, RECEIVER_NAME, RECEIVER_ROLE, RECEIVER_ORGCODE, RECEIVER_BANKNO, RECEIVER_ACCTNO, RECEIVER_REMARK, RECEIVER_SIGN, IS_REGRESS, REQUEST_MSGID, REQUEST_DT, REQUEST_TYPE, SIGN_DT, AGENCY_BANKNO, BANENDORSEMENT_MARKCODE, IDNB, IS_SIGN, RESPONSE_MSGID, SETTLEMENT_MARK, REJECT_CODE, REJECT_REASON, OVERDUE_REASON, INTRST_RATE, PAY_MONEY, RPD_OPEN_DT, RPD_DUE_DT, RPD_INTRST_RATE, RPD_AMT, RMRK_BY_PROPSR, BATCH_NB, INVC_NB, AO_ACCN_INF_ACCTNO, AO_ACCN_INF_BANKNO, PRXY_SGNTR, APPLICANT_AGENCY_BANKNO, RECEIVER_AGENCY_BANKNO, OPERATE_STATE, RECOURSE_TYPE, RECOURSE_REASON, RECOURSE_AGREE_DT, RECOURSE_AGREE_MONEY) VALUES " +
		        		"(default, 3046, '110106', 'YTS005', 'RC01', '98988907-4', '305100001008', '2', null, '1', null, '中国民生银行北京分行营业部', 'RC00', '80197796-2', '305100001008', '0', null, '0', 'RM00', '3051000010082016112500063123', '2016-11-25', '031', '2016-11-25', null, 'EM00', '"+billNo+"', 'SU00', '3051000010082016112500063217', 'SM01', null, null, null, '0.300000', '1093.40', null, null, null, null, null, null, null, '2', '305100001008', 'PS01', null, null, null, null, null, null, null)," +
		        		"(default, 3157, '130101', '中国民生银行北京分行', 'RC00', '80197796-2', '305100001008', '0', null, '中国民生银行北京分行', null, '中国光大银行', null, null, '303100000006', '0', null, null, 'RM00', '3051000010082016112500063220', '2016-11-25', '013', null, null, 'EM00', '"+billNo+"', null, null, 'SM01', null, null, null, '0.0', '8726.00', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null)," +
		        		"(default, 3158, '130106', '中国民生银行北京分行', 'RC00', '80197796-2', '305100001008', '0', null, '中国民生银行北京分行', null, '中国光大银行', 'RC00', '51799853-9', '303100000006', '0', null, '0', 'RM00', '3051000010082016112500063220', '2016-11-25', '031', '2016-11-25', null, 'EM00', '"+billNo+"', 'SU00', '3031000000062016112510006724', 'SM01', null, null, null, '0.0', '8726.00', null, null, null, null, null, null, null, null, null, 'PS01', null, null, null, null, null, null, null)";
		        stment1.execute(ecdsHistSql);
		        stment1.close();
		        String histId1=sequenceService.getPrimaryKeyValue();
		        String histId2=sequenceService.getPrimaryKeyValue();
		        String histId3=sequenceService.getPrimaryKeyValue();
		        String rcBillInfoSql="update trgct_bill_info set bill_source='1',cur_status='I_02' where id=?";
		        session.execute(rcBillInfoSql,rgctId);
		        String rcBillHistSql="INSERT INTO TRGCT_BILL_HIST (HIST_ID, RGCT_ID, CUR_STATUS, PRE_STATUS, RUN_STATUS, BATCH_ID, FROM_NAME, FROM_CUST_NO, FROM_ACCT_NO, FROM_BANK_NO, FROM_BRANCH_NO, FROM_SIGN, TO_NAME, TO_CUST_NO, TO_ACCT_NO, TO_BANK_NO, TO_BRANCH_NO, SIGN_DT, SIGN_TIME, INTEREST_RATE, INTEREST, DEAL_MONEY, IS_REGRESS, REGRESS_DT, REGRESS_TIME, REGRESS_PRICE, BACK_OPEN_DT, BACK_END_DT, BACK_RATE, BACK_AMOUNT, IF_INNER, IS_BUY, SIGNER, SIGNER_SIGN, SIGN_FLAG, HOLD_CUST_NO, HOLD_CUST_NAME, HOLD_ACCT_NO, HOLD_BANK_NO, OBLIGEE_CUST_NO, OBLIGEE_CUST_NAME, OBLIGEE_BANK_NO, OBLIGEE_ACCT_NO, RETURN_CODE, OPER_DATE, OPER_TIME, OPER_NO, CHANNEL, IS_LOCK, LOCK_BRANCH_NO, LOCK_FLOW_NAME, STEP_NAME, VALID_HIST_ID, LAST_HIST_ID, IS_ONLINE, OVERDUE_RS, IS_ACCPT, DRAFT_LOG_ID, REJECT_CODE, REJECT_REASON, IS_REDISC_CENTER, ASSU_ID, RECOURSE_ID, IS_DELEGATE, IN_ACCT_NO, IN_BANK_NO, PARTNER_CODE, PAY_TRADE_NO, FORBID_FLAG, FROM_REMARK, TO_REMARK, DRAFT_INFO, OLD_INTEREST_RATE, OLD_DIS_DT, DELAY_DAYS, DELAY_TYPE, BILL_TRACK, IS_SAME_CITY, INTEREST_DUE_DT, INTEREST_DAYS, FIRSTBUY_INTEREST, FROM_ORGCODE, TO_ORGCODE, FROM_ROLE, TO_ROLE, BILL_BEFORE_OWNER, PROD_ATTR, ACCT_BRANCH_NO, STORAGE_BRANCH_NO, BUY_TYPE, WORKINGADS_NO, WORKINGADS_NAME, STORAGE_BRANCH_NAME, ENDO_HIST_ID, ENDORSES_BANK_NAME, ENDORSES_BANK_NO, ENDORSE_DT, ENDO_STATUS) VALUES " +
		        		"(?, ?, 'F_02', 'F_08', ' ', ?, 'YTS005', '2200006456', '2', '305100001008', ' ', '1', '中国民生银行北京分行营业部', '2200006456', '0', '305100001008', ' ', '2016-11-25', ' ', 0.300000, 0.00, 1093.40, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', '1', '2200006456', '中国民生银行北京分行营业部', '0', '305100001008', '中国民生银行北京分行营业部', ' ', '305100001008', '0', ' ', ' ', '2016-11-25', ' ', ' ', '1', ' ', ' ', '买断式贴现回复', '1600013872', '1600013872', '0', ' ', '1', '1600014897', ' ', ' ', ' ', ' ', ' ', ' ', '2', '305100001008', ' ', ' ', '0', ' ', ' ', ' ', 0.300000, '2016-11-25', '3', ' ', '1', ' ', '2016-12-26', 31, 0.00, '98988907-4', '80197796-2', 'RC01', 'RC00', 'YTS005', ' ', ' ', ' ', '1', ' ', ' ', ' ', '1600014900', ' ', ' ', '2016-11-25', 'F_02')," +
		        		"(?, ?, 'I_11', 'F_02', ' ', ?, '中国民生银行北京分行', '2200006456', '0', '305100001008', ' ', '1', '中国光大银行', '2200006456', '0', '303100000006', ' ', '2016-11-25', ' ', 0.000000, 0.00, 8726.00, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', '1', '2200006456', '中国民生银行北京分行营业部', '0', '305100001008', '中国民生银行北京分行营业部', ' ', '305100001008', '0', ' ', ' ', '2016-11-25', ' ', ' ', '0', ' ', ' ', '买断式转贴现', '1600014900', '1600014900', '0', ' ', '1', '1600014928', ' ', ' ', '0', ' ', ' ', ' ', '2', '305100001008', ' ', ' ', '0', ' ', ' ', ' ', 0.300000, '2016-11-25', '3', ' ', '1', ' ', '2016-12-26', 31, 0.00, '80197796-2', '80197796-2', 'RC00', 'RC00', 'YTS005', ' ', ' ', ' ', '1', ' ', ' ', ' ', '1600014900', ' ', ' ', '2016-11-25', 'F_02')," +
		        		"(?, ?, 'I_02', 'I_11', ' ', ?, '中国民生银行北京分行', '2200006456', '0', '305100001008', ' ', '1', '中国光大银行', '2200006456', '0', '303100000006', ' ', '2016-11-25', ' ', 0.000000, 0.00, 8726.00, '0', ' ', ' ', 0.00, ' ', ' ', 0.000000, 0.000000, ' ', ' ', '2', '0', '1', '2200006456', '中国光大银行', '0', '303100000006', '中国光大银行', ' ', '303100000006', '0', ' ', ' ', '2016-11-25', ' ', ' ', '0', ' ', ' ', '买断式转贴现回复', '1600014930', '1600014930', '0', ' ', '1', '1600014928', ' ', ' ', '0', ' ', ' ', ' ', '2', '305100001008', ' ', ' ', '0', ' ', ' ', ' ', 0.300000, '2016-11-25', '3', ' ', '1', ' ', '2016-12-26', 31, 0.00, '80197796-2', '80197796-2', 'RC00', 'RC00', 'YTS005', ' ', ' ', ' ', '1', ' ', ' ', ' ', '1600014936', ' ', ' ', '2016-11-25', 'I_02')";
		        session.execute(rcBillHistSql,histId1,rgctId,discBatchNo,histId2,rgctId,discBatchNo,histId3,rgctId,discBatchNo);
		        String salebillId=sequenceService.getPrimaryKeyValue();
		        String salebillSql="INSERT INTO TSALE_BILL_INFO (SALEMX_ID, BILL_TYPE, BILL_NO, ISSUE_DT, DUE_DT, REMITTER, REMITTER_ACCT, REMITTER_CUST_NO, REMITTER_BANK_NAME, REMITTER_BANK_NO, BILL_MONEY, ACCEPTOR, PAYEE_NAME, PAYEE_BANK_NAME, PAYEE_ACCT, BILL_BEFORE_OWNER, BILL_OWNER, BILL_CLASS, BILL_SOURCE, OPER_STATUS, SALE_ID, RGCT_ID, BRANCH_NO, CUST_ACCOUNT, IS_SAME_CITY, INTEREST, DELAY_DAYS, GALE_DATE, INTEREST_DAYS, RECEIVE_MONEY, REMARK, CREATE_DATE, CREATE_TIME, DRAWEE_ADDR, PAYEE_BANK_NO, IS_ACCPT, RATE, RATE_TYPE, BUY_DEPT_NO, SALE_PRACT_ID, BUYBACK_MONEY, IS_ONLINE, FORBID_FLAG, BILL_SOURCE_ID, IS_DELAY_IN, EX_SERIAL, IS_BUYBACK, SALE_SQUARE_ID, YZ_SOURCE, BIDIR_SALE_HIST_FLAG, PAY_TRADE_NO, BUY_MONEY, PRIOR_SRC, APPLY_OPER_NO, AUDIT_OPER_NO, ACCT_OPER_NO, APPLY_TELLER_DT, APPLY_TELLER_TIME, AUDIT_TELLER_DT, AUDIT_TELLER_TIME, ACCT_TELLER_DT, ACCT_TELLER_TIME, GATH_MNEY_DATE, ACCOUNT_DATE, CUST_MANAGE, CUST_MANAGE_DEPT_NO, WORK_BRANCH_NO, COST_RATE, DELAY_TYPE, BILL_STORAGE_ORG, IS_INNER, RESALE_DUE_DT, INTEREST_BUYBACK, PAYMONEY_BUYBACK, PRIOR_SRC_ID, BUY_TYPE, CUST_MANAGE_NAME, CUST_MANAGE_DEPT_NAME, WORK_BRANCH_NAME, RESALE_OPEN_DT, OLD_RATE, OLD_GALE_DATE, BATCH_ID, OLD_INTEREST, OLD_INST_CAL_DAYS, ACCEPTOR_BANK_NO, ACCEPTOR_BANK_NAME, OLD_DISC_DT, OLD_FILE_NO, CUR_STATUS, IF_RECOURS_AVIOD, AUDIT_REASON) VALUES " +
		        		"(?, '1', ?, '2016-08-10', '2016-12-26', '测试01', '3', '2200008660', '中国民生银行北京分行营业部', '305100001008', 8726.00, '中国民生银行北京分行', 'YTS005', '中国民生银行北京分行营业部', '2', 'YTS005', 'YTS005', '2', '1', 'BS227', ?, ?, '00010100', ' ', '1', 0.00, 3, '2016-12-26', 31, 8726.00, ' ', '2016-11-25', '17:02:03', '北京金融街道1号', '305100001008', '1', 0.000000, '360', ' ', ' ', 0.000000, '0', '0', ' ', '0', ' ', '0', ' ', '0', '0', ' ', 1093.40, '1', '010001', '010001', ' ', '2016-11-25', '17:02:51', ' ', '2016-11-25', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 3.000000, '0', ' ', '0', ' ', 0.00, 0.00, ?, '1', ' ', ' ', ' ', ' ', 30.000000, '2016-12-26', ' ', 232.69, 32, '305100001008', '中国民生银行北京分行', '2016-11-24', ' ', ' ', ' ', ' ')";
		        session.execute(salebillSql,salebillId,billNo,saleApplyId,rgctId,discBillId);
		        String balanceId=sequenceService.getPrimaryKeyValue();
		        String acctBalaSql="INSERT INTO TACCT_BALANCE (BALANCE_ID, INFO_ID, RGCT_ID, BILL_NO, START_DT, END_DT, CUST_NO, CUST_NAME, PROD_NO, STATUS, CREATE_DT, CREATE_TM, UPDATE_DT, UPDATE_TM, STORAGE_BRCH_NO, STORAGE_BRCH_NAME, ACCT_BRCH_NO, ACCT_BRCH_NAME) VALUES " +
		        		"(?, ?, ?, ?, '2016-11-25', ' ', '2200006456', 'YTS005', '001001003', '1', '161125', '17:00:12', ' ', ' ', ' ', ' ', ' ', ' ')";
		        session.execute(acctBalaSql,balanceId,discBillId,rgctId,billNo);
		        String endoId=sequenceService.getPrimaryKeyValue();
		        String endoId1=sequenceService.getPrimaryKeyValue();
		        String endoHistSql="INSERT INTO TRGCT_ENDO_HIST (ID, RGCT_ID, ENDO_TYPE, FROM_NAME, FROM_ACCT_NO, FROM_BANK_NO, FROM_ORG_CODE, TO_NAME, TO_ACCT_NO, TO_BANK_NO, TO_ORG_CODE, ENDORSE_DT, ENDORSE_TIME, SIGN_DATE, SIGN_TIME, RPD_OPEN_DATE, RPD_DUE_DATE, FORBID_FLAG, IS_REJECT_PRSNT, REJECT_PRSNT_RSN, RECOURSE_TYPE, GUARNTEE_ADR, REMARK, CREATE_TIME, CREATE_DT) VALUES " +
		        		"(?, ?, '1', 'YTS005', '2', '305100001008', '98988907-4', '中国民生银行北京分行营业部', '0', '305100001008', '80197796-2', '2016-11-25', ' ', ' ', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', '2016-11-25', ' ')," +
		        		"(?, ?, '3', '中国民生银行北京分行', '0', '305100001008', '80197796-2', '中国光大银行', '0', '303100000006', '80197796-2', '2016-11-25', ' ', ' ', ' ', ' ', ' ', '0', ' ', ' ', ' ', ' ', ' ', '2016-11-25', ' ')";
		        session.execute(endoHistSql,endoId,rgctId,endoId1,rgctId);
		        }
		        ecdsCon.close();
		        return mv;
		    }

}

